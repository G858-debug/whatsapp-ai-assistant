{"created": 1758903966.0385811, "duration": 100.08932113647461, "exitcode": 1, "root": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant", "environment": {}, "summary": {"passed": 49, "error": 30, "failed": 11, "skipped": 1, "total": 91, "collected": 91}, "collectors": [{"nodeid": "", "outcome": "passed", "result": [{"nodeid": "tests/__init__.py", "type": "Package"}]}, {"nodeid": "tests/test_conversation_flows.py::TestBasicFunctionality", "outcome": "passed", "result": [{"nodeid": "tests/test_conversation_flows.py::TestBasicFunctionality::test_imports_work", "type": "Function", "lineno": 130}, {"nodeid": "tests/test_conversation_flows.py::TestBasicFunctionality::test_mock_message", "type": "Function", "lineno": 136}, {"nodeid": "tests/test_conversation_flows.py::TestBasicFunctionality::test_trainer_registration_mock", "type": "Function", "lineno": 143}]}, {"nodeid": "tests/test_conversation_flows.py::TestPhase1_Registration", "outcome": "passed", "result": [{"nodeid": "tests/test_conversation_flows.py::TestPhase1_Registration::test_basic_setup", "type": "Function", "lineno": 165}, {"nodeid": "tests/test_conversation_flows.py::TestPhase1_Registration::test_mock_registration_flow", "type": "Function", "lineno": 170}]}, {"nodeid": "tests/test_conversation_flows.py", "outcome": "passed", "result": [{"nodeid": "tests/test_conversation_flows.py::TestBasicFunctionality", "type": "Class"}, {"nodeid": "tests/test_conversation_flows.py::TestPhase1_Registration", "type": "Class"}]}, {"nodeid": "tests/test_debug.py", "outcome": "passed", "result": [{"nodeid": "tests/test_debug.py::test_python_version", "type": "Function", "lineno": 9}, {"nodeid": "tests/test_debug.py::test_can_import_basic_modules", "type": "Function", "lineno": 14}, {"nodeid": "tests/test_debug.py::test_project_structure", "type": "Function", "lineno": 28}, {"nodeid": "tests/test_debug.py::test_can_import_refiloe_modules", "type": "Function", "lineno": 48}, {"nodeid": "tests/test_debug.py::test_check_requirements", "type": "Function", "lineno": 84}]}, {"nodeid": "tests/test_e2e_complete.py::TestPhase1_Registration", "outcome": "passed", "result": [{"nodeid": "tests/test_e2e_complete.py::TestPhase1_Registration::test_complete_trainer_onboarding", "type": "Function", "lineno": 97}, {"nodeid": "tests/test_e2e_complete.py::TestPhase1_Registration::test_trainer_recognition_after_registration", "type": "Function", "lineno": 136}]}, {"nodeid": "tests/test_e2e_complete.py::TestPhase2_ClientManagement", "outcome": "passed", "result": [{"nodeid": "tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_add_client_variations", "type": "Function", "lineno": 180}, {"nodeid": "tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_view_clients", "type": "Function", "lineno": 203}, {"nodeid": "tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_custom_pricing", "type": "Function", "lineno": 218}]}, {"nodeid": "tests/test_e2e_complete.py::TestPhase3_Scheduling", "outcome": "passed", "result": [{"nodeid": "tests/test_e2e_complete.py::TestPhase3_Scheduling::test_view_schedule", "type": "Function", "lineno": 267}, {"nodeid": "tests/test_e2e_complete.py::TestPhase3_Scheduling::test_book_sessions", "type": "Function", "lineno": 289}, {"nodeid": "tests/test_e2e_complete.py::TestPhase3_Scheduling::test_cancel_reschedule", "type": "Function", "lineno": 310}]}, {"nodeid": "tests/test_e2e_complete.py", "outcome": "passed", "result": [{"nodeid": "tests/test_e2e_complete.py::TestPhase1_Registration", "type": "Class"}, {"nodeid": "tests/test_e2e_complete.py::TestPhase2_ClientManagement", "type": "Class"}, {"nodeid": "tests/test_e2e_complete.py::TestPhase3_Scheduling", "type": "Class"}]}, {"nodeid": "tests/test_integration_real.py::TestRealIntegration", "outcome": "passed", "result": [{"nodeid": "tests/test_integration_real.py::TestRealIntegration::test_trainer_registration_database", "type": "Function", "lineno": 103}, {"nodeid": "tests/test_integration_real.py::TestRealIntegration::test_client_management_real", "type": "Function", "lineno": 131}, {"nodeid": "tests/test_integration_real.py::TestRealIntegration::test_booking_system_real", "type": "Function", "lineno": 159}, {"nodeid": "tests/test_integration_real.py::TestRealIntegration::test_ai_integration_simple", "type": "Function", "lineno": 192}, {"nodeid": "tests/test_integration_real.py::TestRealIntegration::test_database_connection", "type": "Function", "lineno": 216}]}, {"nodeid": "tests/test_integration_real.py", "outcome": "passed", "result": [{"nodeid": "tests/test_integration_real.py::TestRealIntegration", "type": "Class"}]}, {"nodeid": "tests/test_phase1_registration.py::TestTrainerRegistrationReal", "outcome": "passed", "result": [{"nodeid": "tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_complete_trainer_registration_flow", "type": "Function", "lineno": 77}, {"nodeid": "tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_currency_parsing_variations", "type": "Function", "lineno": 192}, {"nodeid": "tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_registration_with_missing_fields", "type": "Function", "lineno": 211}, {"nodeid": "tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_trainer_recognition_after_registration", "type": "Function", "lineno": 224}]}, {"nodeid": "tests/test_phase1_registration.py::TestClientRegistrationReal", "outcome": "passed", "result": [{"nodeid": "tests/test_phase1_registration.py::TestClientRegistrationReal::test_client_receives_welcome_after_registration", "type": "Function", "lineno": 281}]}, {"nodeid": "tests/test_phase1_registration.py::TestRegistrationEdgeCases", "outcome": "passed", "result": [{"nodeid": "tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_duplicate_registration_attempt", "type": "Function", "lineno": 311}, {"nodeid": "tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_invalid_email_format", "type": "Function", "lineno": 327}, {"nodeid": "tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_extremely_long_input", "type": "Function", "lineno": 341}, {"nodeid": "tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_special_characters_in_name", "type": "Function", "lineno": 358}]}, {"nodeid": "tests/test_phase1_registration.py", "outcome": "passed", "result": [{"nodeid": "tests/test_phase1_registration.py::TestTrainerRegistrationReal", "type": "Class"}, {"nodeid": "tests/test_phase1_registration.py::TestClientRegistrationReal", "type": "Class"}, {"nodeid": "tests/test_phase1_registration.py::TestRegistrationEdgeCases", "type": "Class"}]}, {"nodeid": "tests/test_phase2_client_management.py::TestAddClientReal", "outcome": "passed", "result": [{"nodeid": "tests/test_phase2_client_management.py::TestAddClientReal::test_add_client_command_variations", "type": "Function", "lineno": 47}, {"nodeid": "tests/test_phase2_client_management.py::TestAddClientReal::test_phone_number_normalization", "type": "Function", "lineno": 75}, {"nodeid": "tests/test_phase2_client_management.py::TestAddClientReal::test_add_client_with_special_names", "type": "Function", "lineno": 100}]}, {"nodeid": "tests/test_phase2_client_management.py::TestViewClientsReal", "outcome": "passed", "result": [{"nodeid": "tests/test_phase2_client_management.py::TestViewClientsReal::test_view_clients_commands", "type": "Function", "lineno": 140}]}, {"nodeid": "tests/test_phase2_client_management.py::TestCustomPricingReal", "outcome": "passed", "result": [{"nodeid": "tests/test_phase2_client_management.py::TestCustomPricingReal::test_set_custom_pricing_variations", "type": "Function", "lineno": 188}, {"nodeid": "tests/test_phase2_client_management.py::TestCustomPricingReal::test_check_client_pricing", "type": "Function", "lineno": 220}]}, {"nodeid": "tests/test_phase2_client_management.py::TestClientManagementEdgeCases", "outcome": "passed", "result": [{"nodeid": "tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_add_client_with_duplicate_phone", "type": "Function", "lineno": 253}, {"nodeid": "tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_invalid_phone_numbers", "type": "Function", "lineno": 270}, {"nodeid": "tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_set_negative_pricing", "type": "Function", "lineno": 286}, {"nodeid": "tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_client_not_found", "type": "Function", "lineno": 300}]}, {"nodeid": "tests/test_phase2_client_management.py", "outcome": "passed", "result": [{"nodeid": "tests/test_phase2_client_management.py::TestAddClientReal", "type": "Class"}, {"nodeid": "tests/test_phase2_client_management.py::TestViewClientsReal", "type": "Class"}, {"nodeid": "tests/test_phase2_client_management.py::TestCustomPricingReal", "type": "Class"}, {"nodeid": "tests/test_phase2_client_management.py::TestClientManagementEdgeCases", "type": "Class"}]}, {"nodeid": "tests/test_phase3_scheduling.py::TestViewScheduleReal", "outcome": "passed", "result": [{"nodeid": "tests/test_phase3_scheduling.py::TestViewScheduleReal::test_view_schedule_commands", "type": "Function", "lineno": 53}]}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookSessionsReal", "outcome": "passed", "result": [{"nodeid": "tests/test_phase3_scheduling.py::TestBookSessionsReal::test_book_session_natural_language", "type": "Function", "lineno": 110}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookSessionsReal::test_booking_time_formats", "type": "Function", "lineno": 144}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookSessionsReal::test_booking_date_parsing", "type": "Function", "lineno": 169}]}, {"nodeid": "tests/test_phase3_scheduling.py::TestCancelRescheduleReal", "outcome": "passed", "result": [{"nodeid": "tests/test_phase3_scheduling.py::TestCancelRescheduleReal::test_cancel_booking_variations", "type": "Function", "lineno": 223}, {"nodeid": "tests/test_phase3_scheduling.py::TestCancelRescheduleReal::test_reschedule_booking", "type": "Function", "lineno": 248}]}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookingConflictsAndValidation", "outcome": "passed", "result": [{"nodeid": "tests/test_phase3_scheduling.py::TestBookingConflictsAndValidation::test_double_booking_prevention", "type": "Function", "lineno": 283}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookingConflictsAndValidation::test_past_date_booking_prevention", "type": "Function", "lineno": 313}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookingConflictsAndValidation::test_invalid_time_slots", "type": "Function", "lineno": 334}]}, {"nodeid": "tests/test_phase3_scheduling.py", "outcome": "passed", "result": [{"nodeid": "tests/test_phase3_scheduling.py::TestViewScheduleReal", "type": "Class"}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookSessionsReal", "type": "Class"}, {"nodeid": "tests/test_phase3_scheduling.py::TestCancelRescheduleReal", "type": "Class"}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookingConflictsAndValidation", "type": "Class"}]}, {"nodeid": "tests/test_phases_4_11.py::TestPhase4_HabitTracking", "outcome": "passed", "result": [{"nodeid": "tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_setup_habits_for_clients", "type": "Function", "lineno": 141}, {"nodeid": "tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_check_habit_compliance", "type": "Function", "lineno": 163}, {"nodeid": "tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_send_habit_reminders", "type": "Function", "lineno": 179}]}, {"nodeid": "tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments", "outcome": "passed", "result": [{"nodeid": "tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_send_workouts", "type": "Function", "lineno": 207}, {"nodeid": "tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_start_assessment", "type": "Function", "lineno": 223}, {"nodeid": "tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_view_assessment_results", "type": "Function", "lineno": 239}]}, {"nodeid": "tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue", "outcome": "passed", "result": [{"nodeid": "tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue::test_request_payment", "type": "Function", "lineno": 266}, {"nodeid": "tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue::test_check_revenue", "type": "Function", "lineno": 282}, {"nodeid": "tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue::test_payment_confirmation", "type": "Function", "lineno": 299}]}, {"nodeid": "tests/test_phases_4_11.py::TestPhase7_AnalyticsReports", "outcome": "passed", "result": [{"nodeid": "tests/test_phases_4_11.py::TestPhase7_AnalyticsReports::test_view_dashboard", "type": "Function", "lineno": 326}, {"nodeid": "tests/test_phases_4_11.py::TestPhase7_AnalyticsReports::test_client_analytics", "type": "Function", "lineno": 342}]}, {"nodeid": "tests/test_phases_4_11.py::TestPhase8_ClientFeatures", "outcome": "passed", "result": [{"nodeid": "tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_booking", "type": "Function", "lineno": 371}, {"nodeid": "tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_habit_logging", "type": "Function", "lineno": 387}, {"nodeid": "tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_progress", "type": "Function", "lineno": 404}]}, {"nodeid": "tests/test_phases_4_11.py::TestPhase9_Challenges", "outcome": "passed", "result": [{"nodeid": "tests/test_phases_4_11.py::TestPhase9_Challenges::test_view_challenges", "type": "Function", "lineno": 432}, {"nodeid": "tests/test_phases_4_11.py::TestPhase9_Challenges::test_join_leave_challenges", "type": "Function", "lineno": 448}, {"nodeid": "tests/test_phases_4_11.py::TestPhase9_Challenges::test_leaderboard", "type": "Function", "lineno": 464}]}, {"nodeid": "tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures", "outcome": "passed", "result": [{"nodeid": "tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures::test_bulk_operations", "type": "Function", "lineno": 492}, {"nodeid": "tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures::test_natural_language", "type": "Function", "lineno": 507}, {"nodeid": "tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures::test_error_handling", "type": "Function", "lineno": 523}]}, {"nodeid": "tests/test_phases_4_11.py::TestPhase11_AutomatedFeatures", "outcome": "passed", "result": [{"nodeid": "tests/test_phases_4_11.py::TestPhase11_AutomatedFeatures::test_check_scheduled_reminders", "type": "Function", "lineno": 551}, {"nodeid": "tests/test_phases_4_11.py::TestPhase11_AutomatedFeatures::test_subscription_monitoring", "type": "Function", "lineno": 562}]}, {"nodeid": "tests/test_phases_4_11.py", "outcome": "passed", "result": [{"nodeid": "tests/test_phases_4_11.py::TestPhase4_HabitTracking", "type": "Class"}, {"nodeid": "tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments", "type": "Class"}, {"nodeid": "tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue", "type": "Class"}, {"nodeid": "tests/test_phases_4_11.py::TestPhase7_AnalyticsReports", "type": "Class"}, {"nodeid": "tests/test_phases_4_11.py::TestPhase8_ClientFeatures", "type": "Class"}, {"nodeid": "tests/test_phases_4_11.py::TestPhase9_Challenges", "type": "Class"}, {"nodeid": "tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures", "type": "Class"}, {"nodeid": "tests/test_phases_4_11.py::TestPhase11_AutomatedFeatures", "type": "Class"}]}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase1_UserRegistration", "outcome": "passed", "result": [{"nodeid": "tests/test_refiloe_complete.py::TestPhase1_UserRegistration::test_new_trainer_onboarding", "type": "Function", "lineno": 227}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase1_UserRegistration::test_trainer_recognition", "type": "Function", "lineno": 242}]}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase2_ClientManagement", "outcome": "passed", "result": [{"nodeid": "tests/test_refiloe_complete.py::TestPhase2_ClientManagement::test_add_client_variations", "type": "Function", "lineno": 269}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase2_ClientManagement::test_view_clients", "type": "Function", "lineno": 278}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase2_ClientManagement::test_set_custom_pricing", "type": "Function", "lineno": 286}]}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings", "outcome": "passed", "result": [{"nodeid": "tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings::test_view_schedule", "type": "Function", "lineno": 299}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings::test_book_sessions", "type": "Function", "lineno": 308}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings::test_cancel_reschedule", "type": "Function", "lineno": 317}]}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase4_HabitTracking", "outcome": "passed", "result": [{"nodeid": "tests/test_refiloe_complete.py::TestPhase4_HabitTracking::test_setup_habits", "type": "Function", "lineno": 334}]}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase5_WorkoutsAssessments", "outcome": "passed", "result": [{"nodeid": "tests/test_refiloe_complete.py::TestPhase5_WorkoutsAssessments::test_send_workouts", "type": "Function", "lineno": 347}]}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase6_PaymentsRevenue", "outcome": "passed", "result": [{"nodeid": "tests/test_refiloe_complete.py::TestPhase6_PaymentsRevenue::test_request_payment", "type": "Function", "lineno": 360}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase6_PaymentsRevenue::test_check_revenue", "type": "Function", "lineno": 369}]}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase8_ClientFeatures", "outcome": "passed", "result": [{"nodeid": "tests/test_refiloe_complete.py::TestPhase8_ClientFeatures::test_client_booking", "type": "Function", "lineno": 381}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase8_ClientFeatures::test_client_habit_logging", "type": "Function", "lineno": 390}]}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase10_AdvancedFeatures", "outcome": "passed", "result": [{"nodeid": "tests/test_refiloe_complete.py::TestPhase10_AdvancedFeatures::test_natural_language_understanding", "type": "Function", "lineno": 403}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase10_AdvancedFeatures::test_error_handling", "type": "Function", "lineno": 412}]}, {"nodeid": "tests/test_refiloe_complete.py::TestCriticalBugs", "outcome": "passed", "result": [{"nodeid": "tests/test_refiloe_complete.py::TestCriticalBugs::test_trainer_registration_step_7_currency_parsing", "type": "Function", "lineno": 433}, {"nodeid": "tests/test_refiloe_complete.py::TestCriticalBugs::test_ai_responds_naturally_not_rigid_commands", "type": "Function", "lineno": 457}]}, {"nodeid": "tests/test_refiloe_complete.py", "outcome": "passed", "result": [{"nodeid": "tests/test_refiloe_complete.py::TestPhase1_UserRegistration", "type": "Class"}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase2_ClientManagement", "type": "Class"}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings", "type": "Class"}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase4_HabitTracking", "type": "Class"}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase5_WorkoutsAssessments", "type": "Class"}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase6_PaymentsRevenue", "type": "Class"}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase8_ClientFeatures", "type": "Class"}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase10_AdvancedFeatures", "type": "Class"}, {"nodeid": "tests/test_refiloe_complete.py::TestCriticalBugs", "type": "Class"}]}, {"nodeid": "tests/test_setup_fix.py", "outcome": "passed", "result": []}, {"nodeid": "tests/__init__.py", "outcome": "passed", "result": [{"nodeid": "tests/test_conversation_flows.py", "type": "Module"}, {"nodeid": "tests/test_debug.py", "type": "Module"}, {"nodeid": "tests/test_e2e_complete.py", "type": "Module"}, {"nodeid": "tests/test_integration_real.py", "type": "Module"}, {"nodeid": "tests/test_phase1_registration.py", "type": "Module"}, {"nodeid": "tests/test_phase2_client_management.py", "type": "Module"}, {"nodeid": "tests/test_phase3_scheduling.py", "type": "Module"}, {"nodeid": "tests/test_phases_4_11.py", "type": "Module"}, {"nodeid": "tests/test_refiloe_complete.py", "type": "Module"}, {"nodeid": "tests/test_setup_fix.py", "type": "Module"}]}], "tests": [{"nodeid": "tests/test_conversation_flows.py::TestBasicFunctionality::test_imports_work", "lineno": 130, "outcome": "passed", "keywords": ["test_imports_work", "TestBasicFunctionality", "test_conversation_flows.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.000499031999993349, "outcome": "passed"}, "call": {"duration": 0.0328494590000048, "outcome": "passed"}, "teardown": {"duration": 1.4678392890000111, "outcome": "passed"}}, {"nodeid": "tests/test_conversation_flows.py::TestBasicFunctionality::test_mock_message", "lineno": 136, "outcome": "passed", "keywords": ["test_mock_message", "TestBasicFunctionality", "test_conversation_flows.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0003422089999958189, "outcome": "passed"}, "call": {"duration": 0.021795437999998057, "outcome": "passed"}, "teardown": {"duration": 1.3303101040000058, "outcome": "passed"}}, {"nodeid": "tests/test_conversation_flows.py::TestBasicFunctionality::test_trainer_registration_mock", "lineno": 143, "outcome": "passed", "keywords": ["test_trainer_registration_mock", "TestBasicFunctionality", "test_conversation_flows.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.000269562999989148, "outcome": "passed"}, "call": {"duration": 0.02166775000000598, "outcome": "passed"}, "teardown": {"duration": 1.089557248999995, "outcome": "passed"}}, {"nodeid": "tests/test_conversation_flows.py::TestPhase1_Registration::test_basic_setup", "lineno": 165, "outcome": "passed", "keywords": ["test_basic_setup", "TestPhase1_Registration", "test_conversation_flows.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.022623643999992282, "outcome": "passed"}, "call": {"duration": 9.367499998802487e-05, "outcome": "passed"}, "teardown": {"duration": 1.4866452519999882, "outcome": "passed"}}, {"nodeid": "tests/test_conversation_flows.py::TestPhase1_Registration::test_mock_registration_flow", "lineno": 170, "outcome": "passed", "keywords": ["test_mock_registration_flow", "TestPhase1_Registration", "test_conversation_flows.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02186546799998723, "outcome": "passed"}, "call": {"duration": 0.00018609800000035648, "outcome": "passed"}, "teardown": {"duration": 0.7874163900000042, "outcome": "passed"}}, {"nodeid": "tests/test_debug.py::test_python_version", "lineno": 9, "outcome": "passed", "keywords": ["test_python_version", "test_debug.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00025585800000271774, "outcome": "passed"}, "call": {"duration": 9.809300001961674e-05, "outcome": "passed"}, "teardown": {"duration": 0.8369226020000156, "outcome": "passed"}}, {"nodeid": "tests/test_debug.py::test_can_import_basic_modules", "lineno": 14, "outcome": "passed", "keywords": ["test_can_import_basic_modules", "test_debug.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002334760000053393, "outcome": "passed"}, "call": {"duration": 0.00010210100001017963, "outcome": "passed"}, "teardown": {"duration": 0.8584207090000007, "outcome": "passed"}}, {"nodeid": "tests/test_debug.py::test_project_structure", "lineno": 28, "outcome": "passed", "keywords": ["test_project_structure", "test_debug.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00027334099999620776, "outcome": "passed"}, "call": {"duration": 0.00019780900001364898, "outcome": "passed"}, "teardown": {"duration": 0.8121995950000098, "outcome": "passed"}}, {"nodeid": "tests/test_debug.py::test_can_import_refiloe_modules", "lineno": 48, "outcome": "passed", "keywords": ["test_can_import_refiloe_modules", "test_debug.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002484229999879517, "outcome": "passed"}, "call": {"duration": 0.0003746090000049662, "outcome": "passed"}, "teardown": {"duration": 1.2247930329999974, "outcome": "passed"}}, {"nodeid": "tests/test_debug.py::test_check_requirements", "lineno": 84, "outcome": "passed", "keywords": ["test_check_requirements", "test_debug.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00027987300001086624, "outcome": "passed"}, "call": {"duration": 0.09624030399999128, "outcome": "passed"}, "teardown": {"duration": 0.8575398609999922, "outcome": "passed"}}, {"nodeid": "tests/test_e2e_complete.py::TestPhase1_Registration::test_complete_trainer_onboarding", "lineno": 97, "outcome": "error", "keywords": ["test_complete_trainer_onboarding", "TestPhase1_Registration", "test_e2e_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.7009807899999885, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_e2e_complete.py", "lineno": 31, "message": "ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "traceback": [{"path": "tests/test_e2e_complete.py", "lineno": 91, "message": "in setup_method"}, {"path": "tests/test_e2e_complete.py", "lineno": 31, "message": "in __init__"}], "longrepr": "tests/test_e2e_complete.py:91: in setup_method\n    self.tester = RefiloeE2ETester()\ntests/test_e2e_complete.py:31: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "teardown": {"duration": 0.8521625230000041, "outcome": "passed"}}, {"nodeid": "tests/test_e2e_complete.py::TestPhase1_Registration::test_trainer_recognition_after_registration", "lineno": 136, "outcome": "error", "keywords": ["test_trainer_recognition_after_registration", "TestPhase1_Registration", "test_e2e_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.022315219000006437, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_e2e_complete.py", "lineno": 31, "message": "ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "traceback": [{"path": "tests/test_e2e_complete.py", "lineno": 91, "message": "in setup_method"}, {"path": "tests/test_e2e_complete.py", "lineno": 31, "message": "in __init__"}], "longrepr": "tests/test_e2e_complete.py:91: in setup_method\n    self.tester = RefiloeE2ETester()\ntests/test_e2e_complete.py:31: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "teardown": {"duration": 0.815850858999994, "outcome": "passed"}}, {"nodeid": "tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_add_client_variations", "lineno": 180, "outcome": "error", "keywords": ["test_add_client_variations", "TestPhase2_ClientManagement", "test_e2e_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.023162360000014814, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_e2e_complete.py", "lineno": 31, "message": "ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "traceback": [{"path": "tests/test_e2e_complete.py", "lineno": 166, "message": "in setup_method"}, {"path": "tests/test_e2e_complete.py", "lineno": 31, "message": "in __init__"}], "longrepr": "tests/test_e2e_complete.py:166: in setup_method\n    self.tester = RefiloeE2ETester()\ntests/test_e2e_complete.py:31: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "teardown": {"duration": 0.8181408009999984, "outcome": "passed"}}, {"nodeid": "tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_view_clients", "lineno": 203, "outcome": "error", "keywords": ["test_view_clients", "TestPhase2_ClientManagement", "test_e2e_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02209464599999933, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_e2e_complete.py", "lineno": 31, "message": "ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "traceback": [{"path": "tests/test_e2e_complete.py", "lineno": 166, "message": "in setup_method"}, {"path": "tests/test_e2e_complete.py", "lineno": 31, "message": "in __init__"}], "longrepr": "tests/test_e2e_complete.py:166: in setup_method\n    self.tester = RefiloeE2ETester()\ntests/test_e2e_complete.py:31: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "teardown": {"duration": 0.7712095150000096, "outcome": "passed"}}, {"nodeid": "tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_custom_pricing", "lineno": 218, "outcome": "error", "keywords": ["test_custom_pricing", "TestPhase2_ClientManagement", "test_e2e_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021379961000008052, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_e2e_complete.py", "lineno": 31, "message": "ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "traceback": [{"path": "tests/test_e2e_complete.py", "lineno": 166, "message": "in setup_method"}, {"path": "tests/test_e2e_complete.py", "lineno": 31, "message": "in __init__"}], "longrepr": "tests/test_e2e_complete.py:166: in setup_method\n    self.tester = RefiloeE2ETester()\ntests/test_e2e_complete.py:31: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "teardown": {"duration": 0.9281610789999775, "outcome": "passed"}}, {"nodeid": "tests/test_e2e_complete.py::TestPhase3_Scheduling::test_view_schedule", "lineno": 267, "outcome": "error", "keywords": ["test_view_schedule", "TestPhase3_Scheduling", "test_e2e_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02149901399999976, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_e2e_complete.py", "lineno": 31, "message": "ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "traceback": [{"path": "tests/test_e2e_complete.py", "lineno": 247, "message": "in setup_method"}, {"path": "tests/test_e2e_complete.py", "lineno": 31, "message": "in __init__"}], "longrepr": "tests/test_e2e_complete.py:247: in setup_method\n    self.tester = RefiloeE2ETester()\ntests/test_e2e_complete.py:31: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "teardown": {"duration": 0.8125555260000112, "outcome": "passed"}}, {"nodeid": "tests/test_e2e_complete.py::TestPhase3_Scheduling::test_book_sessions", "lineno": 289, "outcome": "error", "keywords": ["test_book_sessions", "TestPhase3_Scheduling", "test_e2e_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.022631519000015032, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_e2e_complete.py", "lineno": 31, "message": "ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "traceback": [{"path": "tests/test_e2e_complete.py", "lineno": 247, "message": "in setup_method"}, {"path": "tests/test_e2e_complete.py", "lineno": 31, "message": "in __init__"}], "longrepr": "tests/test_e2e_complete.py:247: in setup_method\n    self.tester = RefiloeE2ETester()\ntests/test_e2e_complete.py:31: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "teardown": {"duration": 0.802085629000004, "outcome": "passed"}}, {"nodeid": "tests/test_e2e_complete.py::TestPhase3_Scheduling::test_cancel_reschedule", "lineno": 310, "outcome": "error", "keywords": ["test_cancel_reschedule", "TestPhase3_Scheduling", "test_e2e_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021416110000018307, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_e2e_complete.py", "lineno": 31, "message": "ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "traceback": [{"path": "tests/test_e2e_complete.py", "lineno": 247, "message": "in setup_method"}, {"path": "tests/test_e2e_complete.py", "lineno": 31, "message": "in __init__"}], "longrepr": "tests/test_e2e_complete.py:247: in setup_method\n    self.tester = RefiloeE2ETester()\ntests/test_e2e_complete.py:31: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)"}, "teardown": {"duration": 0.8208671170000059, "outcome": "passed"}}, {"nodeid": "tests/test_integration_real.py::TestRealIntegration::test_trainer_registration_database", "lineno": 103, "outcome": "passed", "keywords": ["test_trainer_registration_database", "TestRealIntegration", "skipif", "test_integration_real.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.25592587299999536, "outcome": "passed"}, "call": {"duration": 0.3893695940000157, "outcome": "passed"}, "teardown": {"duration": 0.756941420000004, "outcome": "passed"}}, {"nodeid": "tests/test_integration_real.py::TestRealIntegration::test_client_management_real", "lineno": 131, "outcome": "passed", "keywords": ["test_client_management_real", "TestRealIntegration", "skipif", "test_integration_real.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002746130000161884, "outcome": "passed"}, "call": {"duration": 0.5761999179999862, "outcome": "passed"}, "teardown": {"duration": 0.7959620530000109, "outcome": "passed"}}, {"nodeid": "tests/test_integration_real.py::TestRealIntegration::test_booking_system_real", "lineno": 159, "outcome": "failed", "keywords": ["test_booking_system_real", "TestRealIntegration", "skipif", "test_integration_real.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.000316641000040363, "outcome": "passed"}, "call": {"duration": 0.3964811109999573, "outcome": "failed", "crash": {"path": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/postgrest/_sync/request_builder.py", "lineno": 70, "message": "postgrest.exceptions.APIError: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': \"Could not find the 'booking_date' column of 'bookings' in the schema cache\"}"}, "traceback": [{"path": "tests/test_integration_real.py", "lineno": 182, "message": "in test_booking_system_real"}, {"path": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/postgrest/_sync/request_builder.py", "lineno": 70, "message": "in execute"}], "longrepr": "tests/test_integration_real.py:182: in test_booking_system_real\n    }).execute()\n/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/postgrest/_sync/request_builder.py:70: in execute\n    raise APIError(r.json())\nE   postgrest.exceptions.APIError: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': \"Could not find the 'booking_date' column of 'bookings' in the schema cache\"}"}, "teardown": {"duration": 0.7446557920000032, "outcome": "passed"}}, {"nodeid": "tests/test_integration_real.py::TestRealIntegration::test_ai_integration_simple", "lineno": 192, "outcome": "skipped", "keywords": ["test_ai_integration_simple", "TestRealIntegration", "skipif", "test_integration_real.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00030459900000323614, "outcome": "passed"}, "call": {"duration": 0.17389276099999051, "outcome": "skipped", "longrepr": "('/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_integration_real.py', 215, \"Skipped: AI API not available: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-4-sonnet-20241022'}, 'request_id': 'req_011CTXKh3A35YHhaq9ZuPVoE'}\")"}, "teardown": {"duration": 0.8330983980000042, "outcome": "passed"}}, {"nodeid": "tests/test_integration_real.py::TestRealIntegration::test_database_connection", "lineno": 216, "outcome": "passed", "keywords": ["test_database_connection", "TestRealIntegration", "skipif", "test_integration_real.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002935390000402549, "outcome": "passed"}, "call": {"duration": 0.20526087199999665, "outcome": "passed"}, "teardown": {"duration": 2.0832662130000017, "outcome": "passed"}}, {"nodeid": "tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_complete_trainer_registration_flow", "lineno": 77, "outcome": "passed", "keywords": ["test_complete_trainer_registration_flow", "critical", "pytestmark", "TestTrainerRegistrationReal", "test_phase1_registration.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0008282860000008441, "outcome": "passed"}, "call": {"duration": 0.04669601500000908, "outcome": "passed"}, "teardown": {"duration": 0.7935211499999468, "outcome": "passed"}}, {"nodeid": "tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_currency_parsing_variations", "lineno": 192, "outcome": "passed", "keywords": ["test_currency_parsing_variations", "critical", "pytestmark", "TestTrainerRegistrationReal", "test_phase1_registration.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.003211106000037489, "outcome": "passed"}, "call": {"duration": 0.00013992200001666788, "outcome": "passed"}, "teardown": {"duration": 0.7967144630000007, "outcome": "passed"}}, {"nodeid": "tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_registration_with_missing_fields", "lineno": 211, "outcome": "passed", "keywords": ["test_registration_with_missing_fields", "TestTrainerRegistrationReal", "test_phase1_registration.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0010386289999928522, "outcome": "passed"}, "call": {"duration": 0.008280791999993653, "outcome": "passed"}, "teardown": {"duration": 0.8093962159999819, "outcome": "passed"}}, {"nodeid": "tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_trainer_recognition_after_registration", "lineno": 224, "outcome": "failed", "keywords": ["test_trainer_recognition_after_registration", "TestTrainerRegistrationReal", "test_phase1_registration.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.002300937000029535, "outcome": "passed"}, "call": {"duration": 0.29743061200002785, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phase1_registration.py", "lineno": 253, "message": "assert ('john' in \"hi <magicmock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! good to hear from you \ud83d\ude0a\" or 'welcome' in \"hi <magicmock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! good to hear from you \ud83d\ude0a\")\n +  where \"hi <magicmock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! good to hear from you \ud83d\ude0a\" = <built-in method lower of str object at 0x56257f1b2cb0>()\n +    where <built-in method lower of str object at 0x56257f1b2cb0> = \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\".lower\n +      where \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\" = <built-in method get of dict object at 0x7f5f632711c0>('response', '')\n +        where <built-in method get of dict object at 0x7f5f632711c0> = {'response': \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\", 'success': True}.get\n +  and   \"hi <magicmock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! good to hear from you \ud83d\ude0a\" = <built-in method lower of str object at 0x56257f1b2cb0>()\n +    where <built-in method lower of str object at 0x56257f1b2cb0> = \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\".lower\n +      where \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\" = <built-in method get of dict object at 0x7f5f632711c0>('response', '')\n +        where <built-in method get of dict object at 0x7f5f632711c0> = {'response': \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\", 'success': True}.get"}, "traceback": [{"path": "tests/test_phase1_registration.py", "lineno": 253, "message": "in test_trainer_recognition_after_registration"}], "log": [{"name": "refiloe", "msg": "AI Intent Handler initialized with Claude", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903894.8116994, "msecs": 811.0, "relativeCreated": 29437.73865699768, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Background scheduler started", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903894.848914, "msecs": 848.0, "relativeCreated": 29474.953174591064, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Routes setup complete", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903894.849856, "msecs": 849.0, "relativeCreated": 29475.895166397095, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Object of type MagicMock is not JSON serializable", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 56, in understand_message\n    prompt = self._create_intent_prompt(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 121, in _create_intent_prompt\n    {json.dumps(context, indent=2)}\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/__init__.py\", line 238, in dumps\n    **kw).encode(obj)\n          ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py\", line 202, in encode\n    chunks = list(chunks)\n             ^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py\", line 432, in _iterencode\n    yield from _iterencode_dict(o, _current_indent_level)\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py\", line 406, in _iterencode_dict\n    yield from chunks\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py\", line 439, in _iterencode\n    o = _default(o)\n        ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py\", line 180, in default\n    raise TypeError(f'Object of type {o.__class__.__name__} '\nTypeError: Object of type MagicMock is not JSON serializable", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903894.868183, "msecs": 868.0, "relativeCreated": 29494.222164154053, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AQGXIDeDs3jufT7rDesysdq\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903895.0592635, "msecs": 59.0, "relativeCreated": 29685.302734375, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}], "longrepr": "tests/test_phase1_registration.py:253: in test_trainer_recognition_after_registration\n    assert 'john' in response.get('response', '').lower() or \\\nE   assert ('john' in \"hi <magicmock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! good to hear from you \ud83d\ude0a\" or 'welcome' in \"hi <magicmock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! good to hear from you \ud83d\ude0a\")\nE    +  where \"hi <magicmock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! good to hear from you \ud83d\ude0a\" = <built-in method lower of str object at 0x56257f1b2cb0>()\nE    +    where <built-in method lower of str object at 0x56257f1b2cb0> = \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\".lower\nE    +      where \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\" = <built-in method get of dict object at 0x7f5f632711c0>('response', '')\nE    +        where <built-in method get of dict object at 0x7f5f632711c0> = {'response': \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\", 'success': True}.get\nE    +  and   \"hi <magicmock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! good to hear from you \ud83d\ude0a\" = <built-in method lower of str object at 0x56257f1b2cb0>()\nE    +    where <built-in method lower of str object at 0x56257f1b2cb0> = \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\".lower\nE    +      where \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\" = <built-in method get of dict object at 0x7f5f632711c0>('response', '')\nE    +        where <built-in method get of dict object at 0x7f5f632711c0> = {'response': \"Hi <MagicMock name='mock.select().eq().single().execute().data.get()' id='140047681543184'>! Good to hear from you \ud83d\ude0a\", 'success': True}.get"}, "teardown": {"duration": 0.7309102490000328, "outcome": "passed"}}, {"nodeid": "tests/test_phase1_registration.py::TestClientRegistrationReal::test_client_receives_welcome_after_registration", "lineno": 281, "outcome": "failed", "keywords": ["test_client_receives_welcome_after_registration", "TestClientRegistrationReal", "test_phase1_registration.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.002854039999988345, "outcome": "passed"}, "call": {"duration": 0.0029890719999912108, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phase1_registration.py", "lineno": 297, "message": "assert False == True\n +  where False = <built-in method get of dict object at 0x7f5f64605500>('success')\n +    where <built-in method get of dict object at 0x7f5f64605500> = {'response': \"Sorry, I'm having a bit of trouble right now. Please try again in a moment! \ud83d\ude0a\", 'success': False}.get"}, "traceback": [{"path": "tests/test_phase1_registration.py", "lineno": 297, "message": "in test_client_receives_welcome_after_registration"}], "log": [{"name": "refiloe", "msg": "Error getting user context: 'list' object has no attribute 'get'", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903895.8022106, "msecs": 802.0, "relativeCreated": 30428.249835968018, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error handling message: 'list' object has no attribute 'get'", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903895.8044145, "msecs": 804.0, "relativeCreated": 30430.453777313232, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}], "longrepr": "tests/test_phase1_registration.py:297: in test_client_receives_welcome_after_registration\n    assert response.get('success') == True\nE   assert False == True\nE    +  where False = <built-in method get of dict object at 0x7f5f64605500>('success')\nE    +    where <built-in method get of dict object at 0x7f5f64605500> = {'response': \"Sorry, I'm having a bit of trouble right now. Please try again in a moment! \ud83d\ude0a\", 'success': False}.get"}, "teardown": {"duration": 0.7761109019999708, "outcome": "passed"}}, {"nodeid": "tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_duplicate_registration_attempt", "lineno": 311, "outcome": "passed", "keywords": ["test_duplicate_registration_attempt", "TestRegistrationEdgeCases", "test_phase1_registration.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0005213439999920411, "outcome": "passed"}, "call": {"duration": 0.0474265990000049, "outcome": "passed"}, "teardown": {"duration": 1.175314622999963, "outcome": "passed"}}, {"nodeid": "tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_invalid_email_format", "lineno": 327, "outcome": "passed", "keywords": ["test_invalid_email_format", "TestRegistrationEdgeCases", "test_phase1_registration.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0008152220000283705, "outcome": "passed"}, "call": {"duration": 0.00014787599997134748, "outcome": "passed"}, "teardown": {"duration": 0.853288407999969, "outcome": "passed"}}, {"nodeid": "tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_extremely_long_input", "lineno": 341, "outcome": "passed", "keywords": ["test_extremely_long_input", "TestRegistrationEdgeCases", "test_phase1_registration.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0005323029999999562, "outcome": "passed"}, "call": {"duration": 9.429600004295935e-05, "outcome": "passed"}, "teardown": {"duration": 0.8318662129999552, "outcome": "passed"}}, {"nodeid": "tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_special_characters_in_name", "lineno": 358, "outcome": "passed", "keywords": ["test_special_characters_in_name", "TestRegistrationEdgeCases", "test_phase1_registration.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0004998430000000553, "outcome": "passed"}, "call": {"duration": 0.00010957400002098439, "outcome": "passed"}, "teardown": {"duration": 0.8554976519999968, "outcome": "passed"}}, {"nodeid": "tests/test_phase2_client_management.py::TestAddClientReal::test_add_client_command_variations", "lineno": 47, "outcome": "passed", "keywords": ["test_add_client_command_variations", "critical", "pytestmark", "TestAddClientReal", "test_phase2_client_management.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02339026599997851, "outcome": "passed", "log": [{"name": "refiloe", "msg": "AI Intent Handler initialized with Claude", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903900.3776655, "msecs": 377.0, "relativeCreated": 35003.70478630066, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "call": {"duration": 2.954365705999976, "outcome": "passed", "log": [{"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903900.3804858, "msecs": 380.0, "relativeCreated": 35006.52503967285, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903900.3811336, "msecs": 381.0, "relativeCreated": 35007.17282295227, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKhsd5EEuji2y6YqSmN'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKhsd5EEuji2y6YqSmN'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903900.5134702, "msecs": 513.0, "relativeCreated": 35139.509439468384, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"APhMSTVDGmlz5du3i7N10Up\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903900.654098, "msecs": 654.0, "relativeCreated": 35280.13730049133, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903900.6549926, "msecs": 654.0, "relativeCreated": 35281.03184700012, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903900.6551528, "msecs": 655.0, "relativeCreated": 35281.19206428528, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKhtpkybNunrkDZzMDo'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKhtpkybNunrkDZzMDo'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.0994723, "msecs": 99.0, "relativeCreated": 35725.51155090332, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"A9L_8f0bINBzY4wess-lWH6\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.2175992, "msecs": 217.0, "relativeCreated": 35843.63842010498, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.2183301, "msecs": 218.0, "relativeCreated": 35844.369411468506, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.2185376, "msecs": 218.0, "relativeCreated": 35844.576835632324, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKhwCPLqxCopGefa8Pj'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKhwCPLqxCopGefa8Pj'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.464265, "msecs": 464.0, "relativeCreated": 36090.304374694824, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"A3w3jnaHf-Htp03uNbYlTRT\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.5941641, "msecs": 594.0, "relativeCreated": 36220.2033996582, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.59495, "msecs": 594.0, "relativeCreated": 36220.98922729492, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.595121, "msecs": 595.0, "relativeCreated": 36221.16017341614, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKhxnsp4mMbTXbGJAfv'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKhxnsp4mMbTXbGJAfv'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.7379375, "msecs": 737.0, "relativeCreated": 36363.97671699524, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"Asu6ZcoY5L7_IThhO1sIdQz\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.8507702, "msecs": 850.0, "relativeCreated": 36476.80950164795, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903901.8522208, "msecs": 852.0, "relativeCreated": 36478.2600402832, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.852594, "msecs": 852.0, "relativeCreated": 36478.6331653595, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903901.8527539, "msecs": 852.0, "relativeCreated": 36478.793144226074, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKhytcMkAL22YLASBnH'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKhytcMkAL22YLASBnH'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.0078495, "msecs": 7.0, "relativeCreated": 36633.888721466064, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AO8wiqYgLOXijs92ajXgnCJ\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.1514673, "msecs": 151.0, "relativeCreated": 36777.50658988953, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.1524143, "msecs": 152.0, "relativeCreated": 36778.45358848572, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.152579, "msecs": 152.0, "relativeCreated": 36778.61833572388, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKi19m5Q7PYsFFiueyN'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKi19m5Q7PYsFFiueyN'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.2536924, "msecs": 253.0, "relativeCreated": 36879.73165512085, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AoF7ZnubbKU_TIZRbvlw8mJ\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.3699996, "msecs": 369.0, "relativeCreated": 36996.03891372681, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903902.3708708, "msecs": 370.0, "relativeCreated": 36996.910095214844, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.371147, "msecs": 371.0, "relativeCreated": 36997.18618392944, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.3712962, "msecs": 371.0, "relativeCreated": 36997.33543395996, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKi25pd8UqAETxEkwK2'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKi25pd8UqAETxEkwK2'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.4869683, "msecs": 486.0, "relativeCreated": 37113.00754547119, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"Aqnm2O6psrWK0adyHJvu0G2\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.6152859, "msecs": 615.0, "relativeCreated": 37241.32513999939, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903902.6159737, "msecs": 615.0, "relativeCreated": 37242.0129776001, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.616252, "msecs": 616.0, "relativeCreated": 37242.29121208191, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.6164181, "msecs": 616.0, "relativeCreated": 37242.45738983154, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKi3AZTVdvaeKNqGppg'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKi3AZTVdvaeKNqGppg'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.7475584, "msecs": 747.0, "relativeCreated": 37373.597621917725, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AzYJGMecDqJp1pLyiE2G-0f\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.862822, "msecs": 862.0, "relativeCreated": 37488.861322402954, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903902.863666, "msecs": 863.0, "relativeCreated": 37489.70532417297, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.863949, "msecs": 863.0, "relativeCreated": 37489.98832702637, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.8643336, "msecs": 864.0, "relativeCreated": 37490.37289619446, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKi4D4dhNoYpD51bgnr'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKi4D4dhNoYpD51bgnr'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903902.98346, "msecs": 983.0, "relativeCreated": 37609.49921607971, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"Agth3XiLXx1t1i5btb_RdfR\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903903.099603, "msecs": 99.0, "relativeCreated": 37725.64220428467, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903903.1004157, "msecs": 100.0, "relativeCreated": 37726.454973220825, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903903.100916, "msecs": 100.0, "relativeCreated": 37726.95517539978, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903903.1010656, "msecs": 101.0, "relativeCreated": 37727.104902267456, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKi5DaxH121XJrBZUXw'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKi5DaxH121XJrBZUXw'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903903.2155073, "msecs": 215.0, "relativeCreated": 37841.54653549194, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AhCEuEDp6ZAN76Ca2e8pelF\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903903.3312478, "msecs": 331.0, "relativeCreated": 37957.287073135376, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "teardown": {"duration": 0.7612009829999806, "outcome": "passed"}}, {"nodeid": "tests/test_phase2_client_management.py::TestAddClientReal::test_phone_number_normalization", "lineno": 75, "outcome": "passed", "keywords": ["test_phone_number_normalization", "critical", "pytestmark", "TestAddClientReal", "test_phase2_client_management.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.022600851999982297, "outcome": "passed", "log": [{"name": "refiloe", "msg": "AI Intent Handler initialized with Claude", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903904.1167917, "msecs": 116.0, "relativeCreated": 38742.830991744995, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "call": {"duration": 0.00019098699999631208, "outcome": "passed"}, "teardown": {"duration": 0.789804601999947, "outcome": "passed"}}, {"nodeid": "tests/test_phase2_client_management.py::TestAddClientReal::test_add_client_with_special_names", "lineno": 100, "outcome": "passed", "keywords": ["test_add_client_with_special_names", "TestAddClientReal", "test_phase2_client_management.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.022581265000042094, "outcome": "passed", "log": [{"name": "refiloe", "msg": "AI Intent Handler initialized with Claude", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903904.9300168, "msecs": 930.0, "relativeCreated": 39556.05602264404, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "call": {"duration": 2.2874156109999717, "outcome": "passed", "log": [{"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903904.9308465, "msecs": 930.0, "relativeCreated": 39556.88571929932, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903904.9315724, "msecs": 931.0, "relativeCreated": 39557.61170387268, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiD2e2Hh3DwQgZjZ7b'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiD2e2Hh3DwQgZjZ7b'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903905.0897374, "msecs": 89.0, "relativeCreated": 39715.776681900024, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AKktGGrlp2OuADmTUtelYE7\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903905.206342, "msecs": 206.0, "relativeCreated": 39832.38124847412, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903905.2071028, "msecs": 207.0, "relativeCreated": 39833.142042160034, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903905.207262, "msecs": 207.0, "relativeCreated": 39833.301305770874, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiED5PFLF1Y4TnwUiM'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiED5PFLF1Y4TnwUiM'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903905.3327234, "msecs": 332.0, "relativeCreated": 39958.762645721436, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"An5DzbYOwu9o9czyWab8Ax7\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903905.6264412, "msecs": 626.0, "relativeCreated": 40252.48050689697, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903905.6273124, "msecs": 627.0, "relativeCreated": 40253.35168838501, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903905.627494, "msecs": 627.0, "relativeCreated": 40253.533363342285, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiG1UNzkZEmsYVqqZv'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiG1UNzkZEmsYVqqZv'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903905.7374783, "msecs": 737.0, "relativeCreated": 40363.51752281189, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AK_7dTPTkJbhA-M0W_s1D9s\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.003564, "msecs": 3.0, "relativeCreated": 40629.603147506714, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.0043087, "msecs": 4.0, "relativeCreated": 40630.34796714783, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.0045042, "msecs": 4.0, "relativeCreated": 40630.54347038269, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiHoNkMpi1pbvn5QVk'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiHoNkMpi1pbvn5QVk'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.2337606, "msecs": 233.0, "relativeCreated": 40859.79986190796, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"A03z_xKlD_IU9yUXPFNCs0D\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.3497577, "msecs": 349.0, "relativeCreated": 40975.796937942505, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.3508377, "msecs": 350.0, "relativeCreated": 40976.876974105835, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.3509974, "msecs": 350.0, "relativeCreated": 40977.03671455383, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiK8FVhw5ABBo2T7hr'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiK8FVhw5ABBo2T7hr'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.461092, "msecs": 461.0, "relativeCreated": 41087.13126182556, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AuTn4tPQbbxSrYTJA1B7Dd2\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.573684, "msecs": 573.0, "relativeCreated": 41199.72324371338, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.5744367, "msecs": 574.0, "relativeCreated": 41200.4759311676, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.574798, "msecs": 574.0, "relativeCreated": 41200.83737373352, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiL53tyFWs5ZPoeVS3'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiL53tyFWs5ZPoeVS3'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.686988, "msecs": 686.0, "relativeCreated": 41313.02738189697, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"A0FSpmi43VcNe28-u7cT_iO\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.8080292, "msecs": 808.0, "relativeCreated": 41434.06844139099, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.8090172, "msecs": 809.0, "relativeCreated": 41435.05644798279, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.8091793, "msecs": 809.0, "relativeCreated": 41435.21857261658, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiM3qR8afWZg7pu6rp'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiM3qR8afWZg7pu6rp'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903906.9267547, "msecs": 926.0, "relativeCreated": 41552.793979644775, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AqeTib6kaANRRM-x14AJQDi\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903907.2167823, "msecs": 216.0, "relativeCreated": 41842.82159805298, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "teardown": {"duration": 0.798654517999978, "outcome": "passed"}}, {"nodeid": "tests/test_phase2_client_management.py::TestViewClientsReal::test_view_clients_commands", "lineno": 140, "outcome": "failed", "keywords": ["test_view_clients_commands", "TestViewClientsReal", "test_phase2_client_management.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0009212809999894489, "outcome": "passed"}, "call": {"duration": 0.23992019799999298, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phase2_client_management.py", "lineno": 160, "message": "AssertionError: Failed to list clients with command: Show my clients\nassert ('sarah' in '' or 'john' in '' or 'mike' in '' or 'client' in '')"}, "traceback": [{"path": "tests/test_phase2_client_management.py", "lineno": 160, "message": "in test_view_clients_commands"}], "log": [{"name": "refiloe", "msg": "Error getting user context: Mock.keys() returned a non-iterable (type Mock)", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903908.018732, "msecs": 18.0, "relativeCreated": 42644.771337509155, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903908.0193202, "msecs": 19.0, "relativeCreated": 42645.3595161438, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiSGcZLReDLEewcQUe'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiSGcZLReDLEewcQUe'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903908.1353672, "msecs": 135.0, "relativeCreated": 42761.40642166138, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"A3A_pnbR4dcTYaGhiLuWu7H\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903908.2559526, "msecs": 255.0, "relativeCreated": 42881.99186325073, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903908.2575178, "msecs": 257.0, "relativeCreated": 42883.557081222534, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}], "longrepr": "tests/test_phase2_client_management.py:160: in test_view_clients_commands\n    assert 'sarah' in message or 'john' in message or 'mike' in message or \\\nE   AssertionError: Failed to list clients with command: Show my clients\nE   assert ('sarah' in '' or 'john' in '' or 'mike' in '' or 'client' in '')"}, "teardown": {"duration": 0.8387749180000128, "outcome": "passed"}}, {"nodeid": "tests/test_phase2_client_management.py::TestCustomPricingReal::test_set_custom_pricing_variations", "lineno": 188, "outcome": "passed", "keywords": ["test_set_custom_pricing_variations", "critical", "pytestmark", "TestCustomPricingReal", "test_phase2_client_management.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0013378579999994145, "outcome": "passed"}, "call": {"duration": 2.0806276980000007, "outcome": "passed", "log": [{"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.1031868, "msecs": 103.0, "relativeCreated": 43729.22611236572, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.1053524, "msecs": 105.0, "relativeCreated": 43731.3916683197, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiWuuxQmdCQnaKv33u'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiWuuxQmdCQnaKv33u'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.2238092, "msecs": 223.0, "relativeCreated": 43849.84850883484, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AEvF626rGtsBv7gP01n_S_H\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.3450766, "msecs": 345.0, "relativeCreated": 43971.115827560425, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903909.3462207, "msecs": 346.0, "relativeCreated": 43972.25999832153, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.346635, "msecs": 346.0, "relativeCreated": 43972.67436981201, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.3467953, "msecs": 346.0, "relativeCreated": 43972.83458709717, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiXvSPCXbsiLQBurtX'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiXvSPCXbsiLQBurtX'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.4668076, "msecs": 466.0, "relativeCreated": 44092.84687042236, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"A7Y9QvgQ9hn614h9P-dCMus\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.5775752, "msecs": 577.0, "relativeCreated": 44203.614473342896, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903909.5784514, "msecs": 578.0, "relativeCreated": 44204.490661621094, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.578826, "msecs": 578.0, "relativeCreated": 44204.86521720886, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.5790162, "msecs": 579.0, "relativeCreated": 44205.055475234985, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiYuUA3EqZosV5m4Tk'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiYuUA3EqZosV5m4Tk'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.6895697, "msecs": 689.0, "relativeCreated": 44315.608978271484, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AJn8cE50jZtQnBx8xbKKYAA\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.8019683, "msecs": 801.0, "relativeCreated": 44428.00760269165, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903909.8028805, "msecs": 802.0, "relativeCreated": 44428.91979217529, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.8034546, "msecs": 803.0, "relativeCreated": 44429.49390411377, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.8036213, "msecs": 803.0, "relativeCreated": 44429.66055870056, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiZsWreCQY8JrPCdZ1'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiZsWreCQY8JrPCdZ1'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903909.913719, "msecs": 913.0, "relativeCreated": 44539.75820541382, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AjBSvWLrDPNOxSvCdJQJw7E\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.1112478, "msecs": 111.0, "relativeCreated": 44737.28704452515, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903910.1122365, "msecs": 112.0, "relativeCreated": 44738.27576637268, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.1126478, "msecs": 112.0, "relativeCreated": 44738.68703842163, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.1128273, "msecs": 112.0, "relativeCreated": 44738.866567611694, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKibBPcmwn8R66csPbS'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKibBPcmwn8R66csPbS'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.2143052, "msecs": 214.0, "relativeCreated": 44840.34442901611, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"A5naYaC14eulgTk7UKoFN9S\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.3306942, "msecs": 330.0, "relativeCreated": 44956.7334651947, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903910.3313482, "msecs": 331.0, "relativeCreated": 44957.38744735718, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.3318837, "msecs": 331.0, "relativeCreated": 44957.92293548584, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.3320377, "msecs": 332.0, "relativeCreated": 44958.07695388794, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKic6xYEq3jEELwQwj6'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKic6xYEq3jEELwQwj6'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.4321432, "msecs": 432.0, "relativeCreated": 45058.18247795105, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AyNr4Eig_nPuH_OXlAxZnFZ\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.717024, "msecs": 717.0, "relativeCreated": 45343.06335449219, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903910.7180502, "msecs": 718.0, "relativeCreated": 45344.08950805664, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.7183282, "msecs": 718.0, "relativeCreated": 45344.36750411987, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.7184975, "msecs": 718.0, "relativeCreated": 45344.536781311035, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKido9ynA1Tnc44RMWK'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKido9ynA1Tnc44RMWK'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.835312, "msecs": 835.0, "relativeCreated": 45461.35115623474, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"A_xrjS1DmzyCWawuid0taRr\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.9489527, "msecs": 948.0, "relativeCreated": 45574.99194145203, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903910.9498749, "msecs": 949.0, "relativeCreated": 45575.91414451599, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.9504437, "msecs": 950.0, "relativeCreated": 45576.48301124573, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903910.9506207, "msecs": 950.0, "relativeCreated": 45576.65991783142, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiemCSaDBuwe2Ntoqz'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKiemCSaDBuwe2Ntoqz'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903911.0651782, "msecs": 65.0, "relativeCreated": 45691.21742248535, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"A49wyczoZ-tmP5pdzqc4npt\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903911.1819685, "msecs": 181.0, "relativeCreated": 45808.00771713257, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903911.1827722, "msecs": 182.0, "relativeCreated": 45808.81142616272, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "teardown": {"duration": 0.8586686770000256, "outcome": "passed"}}, {"nodeid": "tests/test_phase2_client_management.py::TestCustomPricingReal::test_check_client_pricing", "lineno": 220, "outcome": "failed", "keywords": ["test_check_client_pricing", "TestCustomPricingReal", "test_phase2_client_management.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0013839740000207712, "outcome": "passed"}, "call": {"duration": 0.3279085859999782, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phase2_client_management.py", "lineno": 239, "message": "AssertionError: Failed to show pricing with: What is Sarah's rate?\nassert ('r' in '' or 'rand' in '' or False)\n +  where False = any(<generator object TestCustomPricingReal.test_check_client_pricing.<locals>.<genexpr> at 0x7f5f64740660>)"}, "traceback": [{"path": "tests/test_phase2_client_management.py", "lineno": 239, "message": "in test_check_client_pricing"}], "log": [{"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903912.0446064, "msecs": 44.0, "relativeCreated": 46670.64571380615, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903912.0451744, "msecs": 45.0, "relativeCreated": 46671.21362686157, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKijgNU1tDtCXfxqWND'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKijgNU1tDtCXfxqWND'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903912.25095, "msecs": 250.0, "relativeCreated": 46876.98936462402, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"A0exN1MTlJNJOP3h8IMdLSw\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903912.3705633, "msecs": 370.0, "relativeCreated": 46996.6025352478, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903912.3716614, "msecs": 371.0, "relativeCreated": 46997.700691223145, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}], "longrepr": "tests/test_phase2_client_management.py:239: in test_check_client_pricing\n    assert 'r' in message or 'rand' in message or \\\nE   AssertionError: Failed to show pricing with: What is Sarah's rate?\nE   assert ('r' in '' or 'rand' in '' or False)\nE    +  where False = any(<generator object TestCustomPricingReal.test_check_client_pricing.<locals>.<genexpr> at 0x7f5f64740660>)"}, "teardown": {"duration": 0.8011190940000006, "outcome": "passed"}}, {"nodeid": "tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_add_client_with_duplicate_phone", "lineno": 253, "outcome": "failed", "keywords": ["test_add_client_with_duplicate_phone", "TestClientManagementEdgeCases", "test_phase2_client_management.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0004326279999986582, "outcome": "passed"}, "call": {"duration": 0.24344769900000074, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phase2_client_management.py", "lineno": 268, "message": "assert ('already' in '' or 'exists' in '')\n +  where '' = <built-in method lower of str object at 0x7f5f7733fba0>()\n +    where <built-in method lower of str object at 0x7f5f7733fba0> = ''.lower\n +      where '' = <built-in method get of dict object at 0x7f5f63287740>('message', '')\n +        where <built-in method get of dict object at 0x7f5f63287740> = {'response': \"My apologies, I'm having trouble understanding this request. I'll let Support know about this. In the meantime, are you looking to manage clients, check your schedule, or something else?\", 'success': True}.get\n +  and   '' = <built-in method lower of str object at 0x7f5f7733fba0>()\n +    where <built-in method lower of str object at 0x7f5f7733fba0> = ''.lower\n +      where '' = <built-in method get of dict object at 0x7f5f63287740>('message', '')\n +        where <built-in method get of dict object at 0x7f5f63287740> = {'response': \"My apologies, I'm having trouble understanding this request. I'll let Support know about this. In the meantime, are you looking to manage clients, check your schedule, or something else?\", 'success': True}.get"}, "traceback": [{"path": "tests/test_phase2_client_management.py", "lineno": 268, "message": "in test_add_client_with_duplicate_phone"}], "log": [{"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903913.1791737, "msecs": 179.0, "relativeCreated": 47805.21297454834, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903913.181287, "msecs": 181.0, "relativeCreated": 47807.326316833496, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKipKfcTtSRBKm1o4k1'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKipKfcTtSRBKm1o4k1'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903913.3076353, "msecs": 307.0, "relativeCreated": 47933.674573898315, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AK2y6kUzGZFr9H77_JQ3rKk\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903913.4204805, "msecs": 420.0, "relativeCreated": 48046.51975631714, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}], "longrepr": "tests/test_phase2_client_management.py:268: in test_add_client_with_duplicate_phone\n    assert 'already' in response.get('message', '').lower() or \\\nE   assert ('already' in '' or 'exists' in '')\nE    +  where '' = <built-in method lower of str object at 0x7f5f7733fba0>()\nE    +    where <built-in method lower of str object at 0x7f5f7733fba0> = ''.lower\nE    +      where '' = <built-in method get of dict object at 0x7f5f63287740>('message', '')\nE    +        where <built-in method get of dict object at 0x7f5f63287740> = {'response': \"My apologies, I'm having trouble understanding this request. I'll let Support know about this. In the meantime, are you looking to manage clients, check your schedule, or something else?\", 'success': True}.get\nE    +  and   '' = <built-in method lower of str object at 0x7f5f7733fba0>()\nE    +    where <built-in method lower of str object at 0x7f5f7733fba0> = ''.lower\nE    +      where '' = <built-in method get of dict object at 0x7f5f63287740>('message', '')\nE    +        where <built-in method get of dict object at 0x7f5f63287740> = {'response': \"My apologies, I'm having trouble understanding this request. I'll let Support know about this. In the meantime, are you looking to manage clients, check your schedule, or something else?\", 'success': True}.get"}, "teardown": {"duration": 0.8722016730000064, "outcome": "passed"}}, {"nodeid": "tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_invalid_phone_numbers", "lineno": 270, "outcome": "passed", "keywords": ["test_invalid_phone_numbers", "TestClientManagementEdgeCases", "test_phase2_client_management.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00041024600000127975, "outcome": "passed"}, "call": {"duration": 9.988699997620643e-05, "outcome": "passed"}, "teardown": {"duration": 0.8493854650000117, "outcome": "passed"}}, {"nodeid": "tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_set_negative_pricing", "lineno": 286, "outcome": "passed", "keywords": ["test_set_negative_pricing", "TestClientManagementEdgeCases", "test_phase2_client_management.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0003821029999926395, "outcome": "passed"}, "call": {"duration": 9.256200002027981e-05, "outcome": "passed"}, "teardown": {"duration": 0.8465683109999986, "outcome": "passed"}}, {"nodeid": "tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_client_not_found", "lineno": 300, "outcome": "failed", "keywords": ["test_client_not_found", "TestClientManagementEdgeCases", "test_phase2_client_management.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00041400300000304924, "outcome": "passed"}, "call": {"duration": 0.2781104460000279, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phase2_client_management.py", "lineno": 311, "message": "assert ('not found' in '' or \"doesn't exist\" in '' or 'no client' in '')\n +  where '' = <built-in method lower of str object at 0x7f5f7733fba0>()\n +    where <built-in method lower of str object at 0x7f5f7733fba0> = ''.lower\n +      where '' = <built-in method get of dict object at 0x7f5f632cc0c0>('message', '')\n +        where <built-in method get of dict object at 0x7f5f632cc0c0> = {'response': \"My apologies, I'm having trouble understanding this request. I'll let Support know about this. In the meantime, are you looking to manage clients, check your schedule, or something else?\\n\\nReady to transform your fitness experience? \ud83d\udcaa\\n\\nTell me about yourself:\", 'success': True}.get\n +  and   '' = <built-in method lower of str object at 0x7f5f7733fba0>()\n +    where <built-in method lower of str object at 0x7f5f7733fba0> = ''.lower\n +      where '' = <built-in method get of dict object at 0x7f5f632cc0c0>('message', '')\n +        where <built-in method get of dict object at 0x7f5f632cc0c0> = {'response': \"My apologies, I'm having trouble understanding this request. I'll let Support know about this. In the meantime, are you looking to manage clients, check your schedule, or something else?\\n\\nReady to transform your fitness experience? \ud83d\udcaa\\n\\nTell me about yourself:\", 'success': True}.get\n +  and   '' = <built-in method lower of str object at 0x7f5f7733fba0>()\n +    where <built-in method lower of str object at 0x7f5f7733fba0> = ''.lower\n +      where '' = <built-in method get of dict object at 0x7f5f632cc0c0>('message', '')\n +        where <built-in method get of dict object at 0x7f5f632cc0c0> = {'response': \"My apologies, I'm having trouble understanding this request. I'll let Support know about this. In the meantime, are you looking to manage clients, check your schedule, or something else?\\n\\nReady to transform your fitness experience? \ud83d\udcaa\\n\\nTell me about yourself:\", 'success': True}.get"}, "traceback": [{"path": "tests/test_phase2_client_management.py", "lineno": 311, "message": "in test_client_not_found"}], "log": [{"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903915.999671, "msecs": 999.0, "relativeCreated": 50625.71024894714, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error creating conversation state: 'Mock' object is not subscriptable", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903916.0002651, "msecs": 0.0, "relativeCreated": 50626.304388046265, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKj2NxfM9eSZHTQ3QzF'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKj2NxfM9eSZHTQ3QzF'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903916.1233377, "msecs": 123.0, "relativeCreated": 50749.37701225281, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AU864OMrHOSwn6gCIOoDe7d\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903916.272877, "msecs": 272.0, "relativeCreated": 50898.916244506836, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903916.2743995, "msecs": 274.0, "relativeCreated": 50900.43878555298, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}], "longrepr": "tests/test_phase2_client_management.py:311: in test_client_not_found\n    assert 'not found' in response.get('message', '').lower() or \\\nE   assert ('not found' in '' or \"doesn't exist\" in '' or 'no client' in '')\nE    +  where '' = <built-in method lower of str object at 0x7f5f7733fba0>()\nE    +    where <built-in method lower of str object at 0x7f5f7733fba0> = ''.lower\nE    +      where '' = <built-in method get of dict object at 0x7f5f632cc0c0>('message', '')\nE    +        where <built-in method get of dict object at 0x7f5f632cc0c0> = {'response': \"My apologies, I'm having trouble understanding this request. I'll let Support know about this. In the meantime, are you looking to manage clients, check your schedule, or something else?\\n\\nReady to transform your fitness experience? \ud83d\udcaa\\n\\nTell me about yourself:\", 'success': True}.get\nE    +  and   '' = <built-in method lower of str object at 0x7f5f7733fba0>()\nE    +    where <built-in method lower of str object at 0x7f5f7733fba0> = ''.lower\nE    +      where '' = <built-in method get of dict object at 0x7f5f632cc0c0>('message', '')\nE    +        where <built-in method get of dict object at 0x7f5f632cc0c0> = {'response': \"My apologies, I'm having trouble understanding this request. I'll let Support know about this. In the meantime, are you looking to manage clients, check your schedule, or something else?\\n\\nReady to transform your fitness experience? \ud83d\udcaa\\n\\nTell me about yourself:\", 'success': True}.get\nE    +  and   '' = <built-in method lower of str object at 0x7f5f7733fba0>()\nE    +    where <built-in method lower of str object at 0x7f5f7733fba0> = ''.lower\nE    +      where '' = <built-in method get of dict object at 0x7f5f632cc0c0>('message', '')\nE    +        where <built-in method get of dict object at 0x7f5f632cc0c0> = {'response': \"My apologies, I'm having trouble understanding this request. I'll let Support know about this. In the meantime, are you looking to manage clients, check your schedule, or something else?\\n\\nReady to transform your fitness experience? \ud83d\udcaa\\n\\nTell me about yourself:\", 'success': True}.get"}, "teardown": {"duration": 0.8373006260000011, "outcome": "passed"}}, {"nodeid": "tests/test_phase3_scheduling.py::TestViewScheduleReal::test_view_schedule_commands", "lineno": 53, "outcome": "failed", "keywords": ["test_view_schedule_commands", "TestViewScheduleReal", "test_phase3_scheduling.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0011997599999631348, "outcome": "passed"}, "call": {"duration": 0.2279114080000113, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phase3_scheduling.py", "lineno": 74, "message": "AssertionError: Failed to show schedule with: Show my schedule\nassert ('schedule' in '' or 'booking' in '' or 'session' in '' or 'appointment' in '' or 'no bookings' in '' or 'free' in '')"}, "traceback": [{"path": "tests/test_phase3_scheduling.py", "lineno": 74, "message": "in test_view_schedule_commands"}], "log": [{"name": "refiloe", "msg": "Error getting user context: Mock.keys() returned a non-iterable (type Mock)", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903917.1188493, "msecs": 118.0, "relativeCreated": 51744.88854408264, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903917.1210268, "msecs": 121.0, "relativeCreated": 51747.066020965576, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKj7ACKHm9vfYmkcNpQ'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKj7ACKHm9vfYmkcNpQ'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903917.2310605, "msecs": 231.0, "relativeCreated": 51857.099771499634, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AZTmndlHwijf3i_v6l6CxJ9\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903917.3439589, "msecs": 343.0, "relativeCreated": 51969.9981212616, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903917.3455598, "msecs": 345.0, "relativeCreated": 51971.599102020264, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}], "longrepr": "tests/test_phase3_scheduling.py:74: in test_view_schedule_commands\n    assert 'schedule' in message or 'booking' in message or \\\nE   AssertionError: Failed to show schedule with: Show my schedule\nE   assert ('schedule' in '' or 'booking' in '' or 'session' in '' or 'appointment' in '' or 'no bookings' in '' or 'free' in '')"}, "teardown": {"duration": 0.9742629149999971, "outcome": "passed"}}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookSessionsReal::test_book_session_natural_language", "lineno": 110, "outcome": "passed", "keywords": ["test_book_session_natural_language", "critical", "pytestmark", "TestBookSessionsReal", "test_phase3_scheduling.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.022848213999964173, "outcome": "passed", "log": [{"name": "refiloe", "msg": "AI Intent Handler initialized with Claude", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903918.34751, "msecs": 347.0, "relativeCreated": 52973.549365997314, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "call": {"duration": 1.2365137640000512, "outcome": "passed", "log": [{"name": "refiloe", "msg": "AI intent understanding failed: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjCURiiHMXpKC3UJB9'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.AuthenticationError: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjCURiiHMXpKC3UJB9'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903918.46153, "msecs": 461.0, "relativeCreated": 53087.56923675537, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjCtEEAvXuMmLSuGtq'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.AuthenticationError: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjCtEEAvXuMmLSuGtq'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903918.5575352, "msecs": 557.0, "relativeCreated": 53183.57443809509, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjDJY4kr5r6Dh4pLz2'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.AuthenticationError: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjDJY4kr5r6Dh4pLz2'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903918.6569872, "msecs": 656.0, "relativeCreated": 53283.026456832886, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjDm51EeJbc5BpQQvK'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.AuthenticationError: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjDm51EeJbc5BpQQvK'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903918.7659774, "msecs": 765.0, "relativeCreated": 53392.016649246216, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjEBsDK3n23wsGXAJU'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.AuthenticationError: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjEBsDK3n23wsGXAJU'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903918.8950639, "msecs": 895.0, "relativeCreated": 53521.10314369202, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjExzVoPEeX4E2ERSS'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.AuthenticationError: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjExzVoPEeX4E2ERSS'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903919.0640247, "msecs": 64.0, "relativeCreated": 53690.06395339966, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjFTWVuqLMv4mwALf5'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.AuthenticationError: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjFTWVuqLMv4mwALf5'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903919.1608393, "msecs": 160.0, "relativeCreated": 53786.87858581543, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjFspQE1eadVt5pKRj'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.AuthenticationError: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjFspQE1eadVt5pKRj'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903919.2589443, "msecs": 258.0, "relativeCreated": 53884.9835395813, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjGKc8TqQv4kKs3ikN'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.AuthenticationError: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjGKc8TqQv4kKs3ikN'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903919.3738208, "msecs": 373.0, "relativeCreated": 53999.86004829407, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjGq7V5V8vnuogHkPG'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.AuthenticationError: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjGq7V5V8vnuogHkPG'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903919.4785366, "msecs": 478.0, "relativeCreated": 54104.575872421265, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjHGu9LtGZwFsuQcug'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.AuthenticationError: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}, 'request_id': 'req_011CTXKjHGu9LtGZwFsuQcug'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903919.5836904, "msecs": 583.0, "relativeCreated": 54209.72967147827, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "teardown": {"duration": 0.8757039270000178, "outcome": "passed"}}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookSessionsReal::test_booking_time_formats", "lineno": 144, "outcome": "passed", "keywords": ["test_booking_time_formats", "TestBookSessionsReal", "test_phase3_scheduling.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.023073144000022694, "outcome": "passed", "log": [{"name": "refiloe", "msg": "AI Intent Handler initialized with Claude", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903920.4836233, "msecs": 483.0, "relativeCreated": 55109.6625328064, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "call": {"duration": 0.0014059950000273602, "outcome": "passed"}, "teardown": {"duration": 0.8762664070000028, "outcome": "passed"}}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookSessionsReal::test_booking_date_parsing", "lineno": 169, "outcome": "passed", "keywords": ["test_booking_date_parsing", "TestBookSessionsReal", "test_phase3_scheduling.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02299542800000154, "outcome": "passed", "log": [{"name": "refiloe", "msg": "AI Intent Handler initialized with Claude", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903921.3848755, "msecs": 384.0, "relativeCreated": 56010.91480255127, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "call": {"duration": 0.00040183999999499065, "outcome": "passed"}, "teardown": {"duration": 0.8689441700000202, "outcome": "passed"}}, {"nodeid": "tests/test_phase3_scheduling.py::TestCancelRescheduleReal::test_cancel_booking_variations", "lineno": 223, "outcome": "passed", "keywords": ["test_cancel_booking_variations", "TestCancelRescheduleReal", "test_phase3_scheduling.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.003207708999980241, "outcome": "passed"}, "call": {"duration": 2.0964936670000043, "outcome": "passed", "log": [{"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903922.2589474, "msecs": 258.0, "relativeCreated": 56884.98663902283, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903922.2595308, "msecs": 259.0, "relativeCreated": 56885.57004928589, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjVB1t7FaQdfacBBbU'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjVB1t7FaQdfacBBbU'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903922.4032786, "msecs": 403.0, "relativeCreated": 57029.31785583496, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"Ad74cR4BIaMW8IvEbE3LW8a\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903922.518242, "msecs": 518.0, "relativeCreated": 57144.28114891052, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903922.5193155, "msecs": 519.0, "relativeCreated": 57145.35474777222, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903922.519507, "msecs": 519.0, "relativeCreated": 57145.546197891235, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjWF1bHaGuRQhjmee7'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjWF1bHaGuRQhjmee7'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903922.6518817, "msecs": 651.0, "relativeCreated": 57277.920961380005, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"Ax3vWloiwC3qy-SBJjlxhJS\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903922.9183266, "msecs": 918.0, "relativeCreated": 57544.365882873535, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903922.9193087, "msecs": 919.0, "relativeCreated": 57545.347929000854, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903922.9194982, "msecs": 919.0, "relativeCreated": 57545.53747177124, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjXxSufMZSst2DGA3N'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjXxSufMZSst2DGA3N'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.0278192, "msecs": 27.0, "relativeCreated": 57653.85842323303, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AIClctl-yymvZ1ZOAsfUkon\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.1443665, "msecs": 144.0, "relativeCreated": 57770.405769348145, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903923.145998, "msecs": 145.0, "relativeCreated": 57772.03726768494, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.1463509, "msecs": 146.0, "relativeCreated": 57772.39012718201, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.146525, "msecs": 146.0, "relativeCreated": 57772.56417274475, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjYzTQXr81KDgfC69L'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjYzTQXr81KDgfC69L'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.2826395, "msecs": 282.0, "relativeCreated": 57908.67877006531, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"ALIkCzEvMcES58UeFKGQbkU\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.4012141, "msecs": 401.0, "relativeCreated": 58027.25338935852, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.4020545, "msecs": 402.0, "relativeCreated": 58028.09381484985, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.4024625, "msecs": 402.0, "relativeCreated": 58028.501749038696, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKja1UnA6VgcYLxKJLR'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKja1UnA6VgcYLxKJLR'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.517999, "msecs": 517.0, "relativeCreated": 58144.03820037842, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AexM_FWWNuFiHTJDXy5M2F_\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.6298325, "msecs": 629.0, "relativeCreated": 58255.87177276611, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.631083, "msecs": 631.0, "relativeCreated": 58257.1222782135, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.6312823, "msecs": 631.0, "relativeCreated": 58257.32159614563, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjb1VwQo9Bg83Voa78'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjb1VwQo9Bg83Voa78'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.765478, "msecs": 765.0, "relativeCreated": 58391.517162323, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AM0eNrgBvijWISiBQ7TyQ_Y\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.8807137, "msecs": 880.0, "relativeCreated": 58506.75296783447, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903923.8818176, "msecs": 881.0, "relativeCreated": 58507.85684585571, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.882117, "msecs": 882.0, "relativeCreated": 58508.156299591064, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.882293, "msecs": 882.0, "relativeCreated": 58508.33225250244, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjc4znekwvzh3B6Bem'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjc4znekwvzh3B6Bem'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903923.9959836, "msecs": 995.0, "relativeCreated": 58622.02286720276, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"ADtl58smbk33y4lTkG4i5Gu\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903924.1116834, "msecs": 111.0, "relativeCreated": 58737.722635269165, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903924.1123776, "msecs": 112.0, "relativeCreated": 58738.41691017151, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903924.1129582, "msecs": 112.0, "relativeCreated": 58738.99745941162, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903924.1131134, "msecs": 113.0, "relativeCreated": 58739.152669906616, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjd6WaQPZvQsiSyXag'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjd6WaQPZvQsiSyXag'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903924.236016, "msecs": 236.0, "relativeCreated": 58862.05530166626, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AP6Zk1QkR4RbCYZPVIswqud\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903924.3536913, "msecs": 353.0, "relativeCreated": 58979.7306060791, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "teardown": {"duration": 0.9533724629999938, "outcome": "passed"}}, {"nodeid": "tests/test_phase3_scheduling.py::TestCancelRescheduleReal::test_reschedule_booking", "lineno": 248, "outcome": "passed", "keywords": ["test_reschedule_booking", "TestCancelRescheduleReal", "test_phase3_scheduling.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0011289280000141844, "outcome": "passed"}, "call": {"duration": 1.2679259290000005, "outcome": "passed", "log": [{"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903925.3107586, "msecs": 310.0, "relativeCreated": 59936.797857284546, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903925.3113637, "msecs": 311.0, "relativeCreated": 59937.402963638306, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjiD6HTsmPaTUapcUu'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjiD6HTsmPaTUapcUu'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903925.4341562, "msecs": 434.0, "relativeCreated": 60060.195446014404, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"Asj7FQMAI71ENd6mAiv0Ls3\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903925.5473642, "msecs": 547.0, "relativeCreated": 60173.40350151062, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903925.5483294, "msecs": 548.0, "relativeCreated": 60174.36861991882, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903925.5485227, "msecs": 548.0, "relativeCreated": 60174.561977386475, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjjDNLxaNWzNh774V8'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjjDNLxaNWzNh774V8'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903925.666175, "msecs": 666.0, "relativeCreated": 60292.21415519714, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AVUaCJ_ARZkeYDgiK0-6zQ9\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903925.7794855, "msecs": 779.0, "relativeCreated": 60405.52473068237, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903925.7811751, "msecs": 781.0, "relativeCreated": 60407.214403152466, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903925.7815528, "msecs": 781.0, "relativeCreated": 60407.59205818176, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903925.7817101, "msecs": 781.0, "relativeCreated": 60407.74941444397, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjkC9asr33uwULj96c'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjkC9asr33uwULj96c'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903925.8936408, "msecs": 893.0, "relativeCreated": 60519.68002319336, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"AwFbV7Chp2AtoSIZeux63P0\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903926.0067317, "msecs": 6.0, "relativeCreated": 60632.771015167236, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903926.0077877, "msecs": 7.0, "relativeCreated": 60633.82697105408, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903926.0079486, "msecs": 7.0, "relativeCreated": 60633.98790359497, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjm9CjNPUHzDVjrfRD'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjm9CjNPUHzDVjrfRD'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903926.1138816, "msecs": 113.0, "relativeCreated": 60739.92085456848, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"A8DdwopuTa0_WBjCyB_N_pV\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903926.2877078, "msecs": 287.0, "relativeCreated": 60913.74707221985, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903926.2884688, "msecs": 288.0, "relativeCreated": 60914.50810432434, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting user context: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903926.289004, "msecs": 289.0, "relativeCreated": 60915.043354034424, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Error getting conversation history: 'Mock' object is not reversible", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903926.2891614, "msecs": 289.0, "relativeCreated": 60915.20071029663, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "AI intent understanding failed: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjnNcwHNB3Uszgxk5t'}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/ai_intent_handler.py\", line 64, in understand_message\n    response = self.client.messages.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_utils/_utils.py\", line 275, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/resources/messages.py\", line 888, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1277, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 954, in request\n    return self._request(\n           ^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anthropic/_base_client.py\", line 1058, in _request\n    raise self._make_status_error_from_response(err.response) from None\nanthropic.NotFoundError: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-sonnet-4-20250822'}, 'request_id': 'req_011CTXKjnNcwHNB3Uszgxk5t'}", "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903926.401192, "msecs": 401.0, "relativeCreated": 61027.231216430664, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Failed to send button message: {\"error\":{\"message\":\"Invalid OAuth access token - Cannot parse access token\",\"type\":\"OAuthException\",\"code\":190,\"fbtrace_id\":\"Ajac7kD1p81wGoyvladvA1B\"}}", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903926.576689, "msecs": 576.0, "relativeCreated": 61202.728271484375, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}, {"name": "refiloe", "msg": "Updated conversation state for 27731863036: AWAITING_REGISTRATION_CHOICE", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 21, "funcName": "log_info", "created": 1758903926.5778735, "msecs": 577.0, "relativeCreated": 61203.91273498535, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "teardown": {"duration": 0.8016203040000391, "outcome": "passed"}}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookingConflictsAndValidation::test_double_booking_prevention", "lineno": 283, "outcome": "passed", "keywords": ["test_double_booking_prevention", "TestBookingConflictsAndValidation", "test_phase3_scheduling.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0005576510000082635, "outcome": "passed"}, "call": {"duration": 0.0014043819999756124, "outcome": "passed", "log": [{"name": "refiloe", "msg": "Error checking booking conflict: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903927.3823752, "msecs": 382.0, "relativeCreated": 62008.41450691223, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "teardown": {"duration": 0.8055037900000457, "outcome": "passed"}}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookingConflictsAndValidation::test_past_date_booking_prevention", "lineno": 313, "outcome": "passed", "keywords": ["test_past_date_booking_prevention", "TestBookingConflictsAndValidation", "test_phase3_scheduling.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0005375339999886819, "outcome": "passed"}, "call": {"duration": 0.001300158000049123, "outcome": "passed", "log": [{"name": "refiloe", "msg": "Error checking booking conflict: object of type 'Mock' has no len()", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/utils/logger.py", "filename": "logger.py", "module": "logger", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 25, "funcName": "log_error", "created": 1758903928.190361, "msecs": 190.0, "relativeCreated": 62816.40028953552, "thread": 140047999703936, "threadName": "MainThread", "processName": "MainProcess", "process": 2213}]}, "teardown": {"duration": 0.9135098070000254, "outcome": "passed"}}, {"nodeid": "tests/test_phase3_scheduling.py::TestBookingConflictsAndValidation::test_invalid_time_slots", "lineno": 334, "outcome": "passed", "keywords": ["test_invalid_time_slots", "TestBookingConflictsAndValidation", "test_phase3_scheduling.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0006062829999677888, "outcome": "passed"}, "call": {"duration": 0.0005583030000479994, "outcome": "passed"}, "teardown": {"duration": 0.8234509200000275, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_setup_habits_for_clients", "lineno": 141, "outcome": "error", "keywords": ["test_setup_habits_for_clients", "TestPhase4_HabitTracking", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021905172999993283, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 137, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:137: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.896537603000013, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_check_habit_compliance", "lineno": 163, "outcome": "error", "keywords": ["test_check_habit_compliance", "TestPhase4_HabitTracking", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021606454999982816, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 137, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:137: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8607708040000261, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_send_habit_reminders", "lineno": 179, "outcome": "error", "keywords": ["test_send_habit_reminders", "TestPhase4_HabitTracking", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021592298999962622, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 137, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:137: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8473635459999969, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_send_workouts", "lineno": 207, "outcome": "error", "keywords": ["test_send_workouts", "TestPhase5_WorkoutsAssessments", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021671246000039446, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 203, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:203: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8933643109999707, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_start_assessment", "lineno": 223, "outcome": "error", "keywords": ["test_start_assessment", "TestPhase5_WorkoutsAssessments", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021488925999960884, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 203, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:203: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8443861179999885, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_view_assessment_results", "lineno": 239, "outcome": "error", "keywords": ["test_view_assessment_results", "TestPhase5_WorkoutsAssessments", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021563674999981686, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 203, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:203: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.97841951099997, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue::test_request_payment", "lineno": 266, "outcome": "error", "keywords": ["test_request_payment", "TestPhase6_PaymentsRevenue", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02150431400002617, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 262, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:262: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8111053960000163, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue::test_check_revenue", "lineno": 282, "outcome": "error", "keywords": ["test_check_revenue", "TestPhase6_PaymentsRevenue", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02156719200002044, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 262, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:262: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8706842329999631, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue::test_payment_confirmation", "lineno": 299, "outcome": "error", "keywords": ["test_payment_confirmation", "TestPhase6_PaymentsRevenue", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021393286999966676, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 262, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:262: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8549912199999881, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase7_AnalyticsReports::test_view_dashboard", "lineno": 326, "outcome": "error", "keywords": ["test_view_dashboard", "TestPhase7_AnalyticsReports", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02159685700002001, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 322, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:322: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8604981550000161, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase7_AnalyticsReports::test_client_analytics", "lineno": 342, "outcome": "error", "keywords": ["test_client_analytics", "TestPhase7_AnalyticsReports", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021473276999984137, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 322, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:322: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.9113293320000366, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_booking", "lineno": 371, "outcome": "error", "keywords": ["test_client_booking", "TestPhase8_ClientFeatures", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021421278999980586, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 365, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:365: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.829176799000038, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_habit_logging", "lineno": 387, "outcome": "error", "keywords": ["test_client_habit_logging", "TestPhase8_ClientFeatures", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02152107500000966, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 365, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:365: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8549740040000415, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_progress", "lineno": 404, "outcome": "error", "keywords": ["test_client_progress", "TestPhase8_ClientFeatures", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0241181749999555, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 365, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:365: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 1.1611971949999997, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase9_Challenges::test_view_challenges", "lineno": 432, "outcome": "error", "keywords": ["test_view_challenges", "TestPhase9_Challenges", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0217454749999888, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 428, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:428: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8470495860000256, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase9_Challenges::test_join_leave_challenges", "lineno": 448, "outcome": "error", "keywords": ["test_join_leave_challenges", "TestPhase9_Challenges", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021631451000018842, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 428, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:428: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8094794219999812, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase9_Challenges::test_leaderboard", "lineno": 464, "outcome": "error", "keywords": ["test_leaderboard", "TestPhase9_Challenges", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021698617000026843, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 428, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:428: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8545213480000484, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures::test_bulk_operations", "lineno": 492, "outcome": "error", "keywords": ["test_bulk_operations", "TestPhase10_AdvancedFeatures", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021688798000013776, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 488, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:488: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.9063970390000122, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures::test_natural_language", "lineno": 507, "outcome": "error", "keywords": ["test_natural_language", "TestPhase10_AdvancedFeatures", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02174989299999197, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 488, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:488: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8998930390000055, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures::test_error_handling", "lineno": 523, "outcome": "error", "keywords": ["test_error_handling", "TestPhase10_AdvancedFeatures", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02149668900000279, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 488, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:488: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8273338879999983, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase11_AutomatedFeatures::test_check_scheduled_reminders", "lineno": 551, "outcome": "error", "keywords": ["test_check_scheduled_reminders", "TestPhase11_AutomatedFeatures", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.021638791999976092, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 547, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:547: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8760138620000362, "outcome": "passed"}}, {"nodeid": "tests/test_phases_4_11.py::TestPhase11_AutomatedFeatures::test_subscription_monitoring", "lineno": 562, "outcome": "error", "keywords": ["test_subscription_monitoring", "TestPhase11_AutomatedFeatures", "test_phases_4_11.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.02143387200004554, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_phases_4_11.py", "lineno": 36, "message": "ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "traceback": [{"path": "tests/test_phases_4_11.py", "lineno": 547, "message": "in setup_method"}, {"path": "tests/test_phases_4_11.py", "lineno": 36, "message": "in __init__"}], "longrepr": "tests/test_phases_4_11.py:32: in __init__\n    from app_core import process_whatsapp_message\nE   ImportError: cannot import name 'process_whatsapp_message' from 'app_core' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/app_core.py)\n\nDuring handling of the above exception, another exception occurred:\ntests/test_phases_4_11.py:547: in setup_method\n    self.tester = RefiloeE2ETesterExtended()\ntests/test_phases_4_11.py:36: in __init__\n    from services.refiloe import process_message\nE   ImportError: cannot import name 'process_message' from 'services.refiloe' (/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/refiloe.py)"}, "teardown": {"duration": 0.8549380009999936, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase1_UserRegistration::test_new_trainer_onboarding", "lineno": 227, "outcome": "passed", "keywords": ["test_new_trainer_onboarding", "TestPhase1_UserRegistration", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002803140000082749, "outcome": "passed"}, "call": {"duration": 0.00521166099997572, "outcome": "passed"}, "teardown": {"duration": 0.9445706919999566, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase1_UserRegistration::test_trainer_recognition", "lineno": 242, "outcome": "passed", "keywords": ["test_trainer_recognition", "TestPhase1_UserRegistration", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00026054599999270067, "outcome": "passed"}, "call": {"duration": 0.0028068909999774405, "outcome": "passed"}, "teardown": {"duration": 0.8218341429999896, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase2_ClientManagement::test_add_client_variations", "lineno": 269, "outcome": "passed", "keywords": ["test_add_client_variations", "TestPhase2_ClientManagement", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002733200000193392, "outcome": "passed"}, "call": {"duration": 0.007691792999992231, "outcome": "passed"}, "teardown": {"duration": 0.8402395690000048, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase2_ClientManagement::test_view_clients", "lineno": 278, "outcome": "passed", "keywords": ["test_view_clients", "TestPhase2_ClientManagement", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00028132500000310756, "outcome": "passed"}, "call": {"duration": 0.002788726999995106, "outcome": "passed"}, "teardown": {"duration": 0.8158329600000229, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase2_ClientManagement::test_set_custom_pricing", "lineno": 286, "outcome": "passed", "keywords": ["test_set_custom_pricing", "TestPhase2_ClientManagement", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00026738899998690613, "outcome": "passed"}, "call": {"duration": 0.004697431000010965, "outcome": "passed"}, "teardown": {"duration": 0.9055643350000082, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings::test_view_schedule", "lineno": 299, "outcome": "passed", "keywords": ["test_view_schedule", "TestPhase3_SchedulingBookings", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002751929999931235, "outcome": "passed"}, "call": {"duration": 0.0047131610000406, "outcome": "passed"}, "teardown": {"duration": 0.8600494259999891, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings::test_book_sessions", "lineno": 308, "outcome": "passed", "keywords": ["test_book_sessions", "TestPhase3_SchedulingBookings", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002976259999627473, "outcome": "passed"}, "call": {"duration": 0.002775451999980305, "outcome": "passed"}, "teardown": {"duration": 0.9121001789999923, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings::test_cancel_reschedule", "lineno": 317, "outcome": "failed", "keywords": ["test_cancel_reschedule", "TestPhase3_SchedulingBookings", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002672790000133318, "outcome": "passed"}, "call": {"duration": 0.010523128999977871, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_refiloe_complete.py", "lineno": 329, "message": "assert ('reschedul' in \"today's schedule:\\n9:00 am - sarah johnson\\n2:00 pm - john doe\" or 'moved' in \"today's schedule:\\n9:00 am - sarah johnson\\n2:00 pm - john doe\")\n +  where \"today's schedule:\\n9:00 am - sarah johnson\\n2:00 pm - john doe\" = <built-in method lower of str object at 0x7f5f7397d3e0>()\n +    where <built-in method lower of str object at 0x7f5f7397d3e0> = \"Today's schedule:\\n9:00 AM - Sarah Johnson\\n2:00 PM - John Doe\".lower\n +  and   \"today's schedule:\\n9:00 am - sarah johnson\\n2:00 pm - john doe\" = <built-in method lower of str object at 0x7f5f7397d3e0>()\n +    where <built-in method lower of str object at 0x7f5f7397d3e0> = \"Today's schedule:\\n9:00 AM - Sarah Johnson\\n2:00 PM - John Doe\".lower"}, "traceback": [{"path": "tests/test_refiloe_complete.py", "lineno": 329, "message": "in test_cancel_reschedule"}], "longrepr": "tests/test_refiloe_complete.py:329: in test_cancel_reschedule\n    assert \"reschedul\" in response['message'].lower() or \"moved\" in response['message'].lower()\nE   assert ('reschedul' in \"today's schedule:\\n9:00 am - sarah johnson\\n2:00 pm - john doe\" or 'moved' in \"today's schedule:\\n9:00 am - sarah johnson\\n2:00 pm - john doe\")\nE    +  where \"today's schedule:\\n9:00 am - sarah johnson\\n2:00 pm - john doe\" = <built-in method lower of str object at 0x7f5f7397d3e0>()\nE    +    where <built-in method lower of str object at 0x7f5f7397d3e0> = \"Today's schedule:\\n9:00 AM - Sarah Johnson\\n2:00 PM - John Doe\".lower\nE    +  and   \"today's schedule:\\n9:00 am - sarah johnson\\n2:00 pm - john doe\" = <built-in method lower of str object at 0x7f5f7397d3e0>()\nE    +    where <built-in method lower of str object at 0x7f5f7397d3e0> = \"Today's schedule:\\n9:00 AM - Sarah Johnson\\n2:00 PM - John Doe\".lower"}, "teardown": {"duration": 0.8730348349999986, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase4_HabitTracking::test_setup_habits", "lineno": 334, "outcome": "passed", "keywords": ["test_setup_habits", "TestPhase4_HabitTracking", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00027309000000741435, "outcome": "passed"}, "call": {"duration": 0.005057173000011517, "outcome": "passed"}, "teardown": {"duration": 0.8496159769999849, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase5_WorkoutsAssessments::test_send_workouts", "lineno": 347, "outcome": "passed", "keywords": ["test_send_workouts", "TestPhase5_WorkoutsAssessments", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00027800899999874673, "outcome": "passed"}, "call": {"duration": 0.005025553999985277, "outcome": "passed"}, "teardown": {"duration": 0.8532187229999977, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase6_PaymentsRevenue::test_request_payment", "lineno": 360, "outcome": "failed", "keywords": ["test_request_payment", "TestPhase6_PaymentsRevenue", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002949109999690336, "outcome": "passed"}, "call": {"duration": 0.006028667000009591, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_refiloe_complete.py", "lineno": 368, "message": "assert ('payment' in \"welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?\" or 'invoice' in \"welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?\")\n +  where \"welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?\" = <built-in method lower of str object at 0x7f5f7399aab0>()\n +    where <built-in method lower of str object at 0x7f5f7399aab0> = \"Welcome to Refiloe! I'm here to help you manage your personal training business. Are you a trainer or a client?\".lower\n +  and   \"welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?\" = <built-in method lower of str object at 0x7f5f7399aab0>()\n +    where <built-in method lower of str object at 0x7f5f7399aab0> = \"Welcome to Refiloe! I'm here to help you manage your personal training business. Are you a trainer or a client?\".lower"}, "traceback": [{"path": "tests/test_refiloe_complete.py", "lineno": 368, "message": "in test_request_payment"}], "longrepr": "tests/test_refiloe_complete.py:368: in test_request_payment\n    assert \"payment\" in response['message'].lower() or \"invoice\" in response['message'].lower()\nE   assert ('payment' in \"welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?\" or 'invoice' in \"welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?\")\nE    +  where \"welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?\" = <built-in method lower of str object at 0x7f5f7399aab0>()\nE    +    where <built-in method lower of str object at 0x7f5f7399aab0> = \"Welcome to Refiloe! I'm here to help you manage your personal training business. Are you a trainer or a client?\".lower\nE    +  and   \"welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?\" = <built-in method lower of str object at 0x7f5f7399aab0>()\nE    +    where <built-in method lower of str object at 0x7f5f7399aab0> = \"Welcome to Refiloe! I'm here to help you manage your personal training business. Are you a trainer or a client?\".lower"}, "teardown": {"duration": 0.817515874000037, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase6_PaymentsRevenue::test_check_revenue", "lineno": 369, "outcome": "passed", "keywords": ["test_check_revenue", "TestPhase6_PaymentsRevenue", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002681210000332612, "outcome": "passed"}, "call": {"duration": 0.005032066000012492, "outcome": "passed"}, "teardown": {"duration": 0.8057916500000033, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase8_ClientFeatures::test_client_booking", "lineno": 381, "outcome": "passed", "keywords": ["test_client_booking", "TestPhase8_ClientFeatures", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00028153599998859136, "outcome": "passed"}, "call": {"duration": 0.005150126999978966, "outcome": "passed"}, "teardown": {"duration": 0.8634893060000195, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase8_ClientFeatures::test_client_habit_logging", "lineno": 390, "outcome": "passed", "keywords": ["test_client_habit_logging", "TestPhase8_ClientFeatures", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00028013299998974617, "outcome": "passed"}, "call": {"duration": 0.006024949999982709, "outcome": "passed"}, "teardown": {"duration": 1.13724586699999, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase10_AdvancedFeatures::test_natural_language_understanding", "lineno": 403, "outcome": "passed", "keywords": ["test_natural_language_understanding", "TestPhase10_AdvancedFeatures", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002726189999862072, "outcome": "passed"}, "call": {"duration": 0.005131771999970169, "outcome": "passed"}, "teardown": {"duration": 0.8392660140000316, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestPhase10_AdvancedFeatures::test_error_handling", "lineno": 412, "outcome": "failed", "keywords": ["test_error_handling", "TestPhase10_AdvancedFeatures", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.0002701239999964855, "outcome": "passed"}, "call": {"duration": 0.0028134730000033414, "outcome": "failed", "crash": {"path": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/tests/test_refiloe_complete.py", "lineno": 424, "message": "assert False\n +  where False = any(<generator object TestPhase10_AdvancedFeatures.test_error_handling.<locals>.<genexpr> at 0x7f5f6438f5a0>)"}, "traceback": [{"path": "tests/test_refiloe_complete.py", "lineno": 424, "message": "in test_error_handling"}], "longrepr": "tests/test_refiloe_complete.py:424: in test_error_handling\n    assert any(word in response['message'].lower() for word in [\"past\", \"future\", \"cannot\"])\nE   assert False\nE    +  where False = any(<generator object TestPhase10_AdvancedFeatures.test_error_handling.<locals>.<genexpr> at 0x7f5f6438f5a0>)"}, "teardown": {"duration": 0.8545218429999863, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestCriticalBugs::test_trainer_registration_step_7_currency_parsing", "lineno": 433, "outcome": "passed", "keywords": ["test_trainer_registration_step_7_currency_parsing", "TestCriticalBugs", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00025227100002211955, "outcome": "passed"}, "call": {"duration": 0.00032320299999355484, "outcome": "passed"}, "teardown": {"duration": 0.8857583569999861, "outcome": "passed"}}, {"nodeid": "tests/test_refiloe_complete.py::TestCriticalBugs::test_ai_responds_naturally_not_rigid_commands", "lineno": 457, "outcome": "passed", "keywords": ["test_ai_responds_naturally_not_rigid_commands", "TestCriticalBugs", "test_refiloe_complete.py", "tests/__init__.py", "whatsapp-ai-assistant"], "setup": {"duration": 0.00026250999997046165, "outcome": "passed"}, "call": {"duration": 0.0026756560000080754, "outcome": "passed"}, "teardown": {"duration": 0.8396879950000198, "outcome": "passed"}}], "warnings": [{"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py", "lineno": 679}, {"message": "\nPyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),\n(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)\nbut was not found to be installed on your system.\nIf this would cause problems for you,\nplease provide us feedback at https://github.com/pandas-dev/pandas/issues/54466\n        ", "category": "DeprecationWarning", "when": "runtest", "filename": "/home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/services/analytics.py", "lineno": 7}]}
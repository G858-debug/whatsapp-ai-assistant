============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-7.4.2, pluggy-1.6.0 -- /opt/hostedtoolcache/Python/3.11.13/x64/bin/python
cachedir: .pytest_cache
metadata: {'Python': '3.11.13', 'Platform': 'Linux-6.11.0-1018-azure-x86_64-with-glibc2.39', 'Packages': {'pytest': '7.4.2', 'pluggy': '1.6.0'}, 'Plugins': {'anyio': '4.11.0', 'html': '4.1.1', 'json-report': '1.5.0', 'cov': '4.1.0', 'metadata': '3.1.1'}, 'CI': 'true', 'JAVA_HOME': '/usr/lib/jvm/temurin-17-jdk-amd64'}
rootdir: /home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant
plugins: anyio-4.11.0, html-4.1.1, json-report-1.5.0, cov-4.1.0, metadata-3.1.1
collecting ... collected 91 items

tests/test_conversation_flows.py::TestBasicFunctionality::test_imports_work PASSED
tests/test_conversation_flows.py::TestBasicFunctionality::test_mock_message PASSED
tests/test_conversation_flows.py::TestBasicFunctionality::test_trainer_registration_mock PASSED
tests/test_conversation_flows.py::TestPhase1_Registration::test_basic_setup PASSED
tests/test_conversation_flows.py::TestPhase1_Registration::test_mock_registration_flow PASSED
tests/test_debug.py::test_python_version Python version: 3.11.13 (main, Jun  4 2025, 04:12:12) [GCC 13.3.0]
PASSED
tests/test_debug.py::test_can_import_basic_modules ✅ pytest imported successfully
✅ json imported successfully
PASSED
tests/test_debug.py::test_project_structure Current directory: /home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant
Directory contents: ['nixpacks.toml', 'test_results_20250928_133157.txt', 'apply-fixes.log', 'WHATSAPP_FLOWS_IMPLEMENTATION.md', 'models', 'requirements.txt', 'summary.txt', '.git', 'fix_test_issues.py', 'utils', 'payfast_webhook.py', 'test_results_20250928_131707.txt', 'test-output.log', 'test_results_20250928_150517.txt', 'services', 'test_results_20250928_151102.txt', '.github', 'test_results_20250928_130003.txt', 'test_results_20250928_131901.txt', 'claude_response.md', 'claude.md', 'static', 'app_routes.py', 'test_railway_api.py', 'whatsapp_flows', 'debug_ai_responses.py', 'voice_helpers.py', '__pycache__', 'fix-generator.log', 'backups', 'SETUP_COMPLETE.md', '.gitignore', '.test_failure_history.json', 'README.md', 'payment_manager.py', '.claude-config.json', 'test_runner.py', 'routes', 'test_flow_system.py', 'test_results_20250928_140657.txt', 'test-results.json', 'test-report.html', 'MANUAL_MIGRATION_GUIDE.md', 'test_results_20250928_131503.txt', 'test_results_20250928_132548.txt', 'Procfile', 'tests', 'apply_migration.py', 'payment_integration.py', 'debug_time.py', 'config.py', 'app.py', 'app_core.py', 'templates', 'comment.txt', 'runtime.txt', 'supabase', 'test_flow_integration.py', 'FLOW_INTEGRATION_SUMMARY.md']
✅ services/ directory exists
   Contents: ['payment_commands.py', 'text_variation_handler.py', 'helpers', 'calendar_service.py', 'refiloe_handlers.py']...
✅ utils/ directory exists
   Contents: ['phone_utils.py', 'logger.py', 'rate_limiter.py', 'railway_api.py', '__pycache__']...
PASSED
tests/test_debug.py::test_can_import_refiloe_modules ✅ services.refiloe imported successfully
✅ services.ai_intent_handler imported successfully
✅ services.registration.trainer_registration imported successfully
✅ utils.logger imported successfully
✅ config imported successfully
PASSED
tests/test_debug.py::test_check_requirements ✅ flask is installed
✅ supabase is installed
✅ anthropic is installed
✅ pytz is installed
✅ requests is installed
PASSED
tests/test_e2e_complete.py::TestPhase1_Registration::test_complete_trainer_onboarding ERROR
tests/test_e2e_complete.py::TestPhase1_Registration::test_trainer_recognition_after_registration ERROR
tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_add_client_variations ERROR
tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_view_clients ERROR
tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_custom_pricing ERROR
tests/test_e2e_complete.py::TestPhase3_Scheduling::test_view_schedule ERROR
tests/test_e2e_complete.py::TestPhase3_Scheduling::test_book_sessions ERROR
tests/test_e2e_complete.py::TestPhase3_Scheduling::test_cancel_reschedule ERROR
tests/test_integration_real.py::TestRealIntegration::test_trainer_registration_database Checking if tables exist...
✅ trainers table exists
✅ Trainer created with ID: 8af8fa96-99c1-456a-97a5-c7456edf8f40
PASSED
tests/test_integration_real.py::TestRealIntegration::test_client_management_real ✅ Client created for trainer de165856-a2c1-4fc3-8713-901e019ef68e
PASSED
tests/test_integration_real.py::TestRealIntegration::test_booking_system_real FAILED
tests/test_integration_real.py::TestRealIntegration::test_ai_integration_simple ✅ AI responded: 4
PASSED
tests/test_integration_real.py::TestRealIntegration::test_database_connection ✅ Database connection successful
PASSED✅ Test data cleaned up

tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_complete_trainer_registration_flow PASSED
tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_currency_parsing_variations PASSED
tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_registration_with_missing_fields PASSED
tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_trainer_recognition_after_registration FAILED
tests/test_phase1_registration.py::TestClientRegistrationReal::test_client_receives_welcome_after_registration FAILED
tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_duplicate_registration_attempt PASSED
tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_invalid_email_format PASSED
tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_extremely_long_input PASSED
tests/test_phase1_registration.py::TestRegistrationEdgeCases::test_special_characters_in_name PASSED
tests/test_phase2_client_management.py::TestAddClientReal::test_add_client_command_variations FAILED
tests/test_phase2_client_management.py::TestAddClientReal::test_phone_number_normalization PASSED
tests/test_phase2_client_management.py::TestAddClientReal::test_add_client_with_special_names PASSED
tests/test_phase2_client_management.py::TestViewClientsReal::test_view_clients_commands FAILED
tests/test_phase2_client_management.py::TestCustomPricingReal::test_set_custom_pricing_variations FAILED
tests/test_phase2_client_management.py::TestCustomPricingReal::test_check_client_pricing FAILED
tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_add_client_with_duplicate_phone FAILED
tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_invalid_phone_numbers PASSED
tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_set_negative_pricing PASSED
tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_client_not_found FAILED
tests/test_phase3_scheduling.py::TestViewScheduleReal::test_view_schedule_commands FAILED
tests/test_phase3_scheduling.py::TestBookSessionsReal::test_book_session_natural_language PASSED
tests/test_phase3_scheduling.py::TestBookSessionsReal::test_booking_time_formats PASSED
tests/test_phase3_scheduling.py::TestBookSessionsReal::test_booking_date_parsing PASSED
tests/test_phase3_scheduling.py::TestCancelRescheduleReal::test_cancel_booking_variations FAILED
tests/test_phase3_scheduling.py::TestCancelRescheduleReal::test_reschedule_booking FAILED
tests/test_phase3_scheduling.py::TestBookingConflictsAndValidation::test_double_booking_prevention PASSED
tests/test_phase3_scheduling.py::TestBookingConflictsAndValidation::test_past_date_booking_prevention PASSED
tests/test_phase3_scheduling.py::TestBookingConflictsAndValidation::test_invalid_time_slots PASSED
tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_setup_habits_for_clients FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_check_habit_compliance FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_send_habit_reminders FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_send_workouts FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_start_assessment FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_view_assessment_results FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue::test_request_payment FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue::test_check_revenue ✅ Revenue check works: Show my revenue...
✅ Revenue check works: This month's earnings...
✅ Revenue check works: Payment history...
✅ Revenue check works: Who owes me money?...
PASSED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue::test_payment_confirmation FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase7_AnalyticsReports::test_view_dashboard FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase7_AnalyticsReports::test_client_analytics FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_booking FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_habit_logging FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_progress FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase9_Challenges::test_view_challenges FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase9_Challenges::test_join_leave_challenges FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase9_Challenges::test_leaderboard FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures::test_bulk_operations FAILED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures::test_natural_language ✅ Natural response to: I'm doing good thanks...
✅ Natural response to: The weather is nice today...
✅ Natural response to: How are you?...
PASSED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures::test_error_handling ✅ Error handled: Book session for NonExistentCl...
✅ Error handled: Schedule me for yesterday...
✅ Error handled: Set price to negative amount...
PASSED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase11_AutomatedFeatures::test_check_scheduled_reminders ⚠️ No reminder system found - may need implementation
PASSED✅ Test data cleaned up

tests/test_phases_4_11.py::TestPhase11_AutomatedFeatures::test_subscription_monitoring ✅ Subscription monitoring exists
PASSED✅ Test data cleaned up

tests/test_refiloe_complete.py::TestPhase1_UserRegistration::test_new_trainer_onboarding PASSED
tests/test_refiloe_complete.py::TestPhase1_UserRegistration::test_trainer_recognition PASSED
tests/test_refiloe_complete.py::TestPhase2_ClientManagement::test_add_client_variations PASSED
tests/test_refiloe_complete.py::TestPhase2_ClientManagement::test_view_clients PASSED
tests/test_refiloe_complete.py::TestPhase2_ClientManagement::test_set_custom_pricing PASSED
tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings::test_view_schedule PASSED
tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings::test_book_sessions PASSED
tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings::test_cancel_reschedule FAILED
tests/test_refiloe_complete.py::TestPhase4_HabitTracking::test_setup_habits PASSED
tests/test_refiloe_complete.py::TestPhase5_WorkoutsAssessments::test_send_workouts PASSED
tests/test_refiloe_complete.py::TestPhase6_PaymentsRevenue::test_request_payment FAILED
tests/test_refiloe_complete.py::TestPhase6_PaymentsRevenue::test_check_revenue PASSED
tests/test_refiloe_complete.py::TestPhase8_ClientFeatures::test_client_booking PASSED
tests/test_refiloe_complete.py::TestPhase8_ClientFeatures::test_client_habit_logging PASSED
tests/test_refiloe_complete.py::TestPhase10_AdvancedFeatures::test_natural_language_understanding PASSED
tests/test_refiloe_complete.py::TestPhase10_AdvancedFeatures::test_error_handling FAILED
tests/test_refiloe_complete.py::TestCriticalBugs::test_trainer_registration_step_7_currency_parsing PASSED
tests/test_refiloe_complete.py::TestCriticalBugs::test_ai_responds_naturally_not_rigid_commands PASSED

==================================== ERRORS ====================================
__ ERROR at setup of TestPhase1_Registration.test_complete_trainer_onboarding __
tests/test_e2e_complete.py:91: in setup_method
    self.tester = RefiloeE2ETester()
tests/test_e2e_complete.py:32: in __init__
    self.process_message = RefiloeService().handle_message
E   TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
_ ERROR at setup of TestPhase1_Registration.test_trainer_recognition_after_registration _
tests/test_e2e_complete.py:91: in setup_method
    self.tester = RefiloeE2ETester()
tests/test_e2e_complete.py:32: in __init__
    self.process_message = RefiloeService().handle_message
E   TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
___ ERROR at setup of TestPhase2_ClientManagement.test_add_client_variations ___
tests/test_e2e_complete.py:166: in setup_method
    self.tester = RefiloeE2ETester()
tests/test_e2e_complete.py:32: in __init__
    self.process_message = RefiloeService().handle_message
E   TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
_______ ERROR at setup of TestPhase2_ClientManagement.test_view_clients ________
tests/test_e2e_complete.py:166: in setup_method
    self.tester = RefiloeE2ETester()
tests/test_e2e_complete.py:32: in __init__
    self.process_message = RefiloeService().handle_message
E   TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
______ ERROR at setup of TestPhase2_ClientManagement.test_custom_pricing _______
tests/test_e2e_complete.py:166: in setup_method
    self.tester = RefiloeE2ETester()
tests/test_e2e_complete.py:32: in __init__
    self.process_message = RefiloeService().handle_message
E   TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
__________ ERROR at setup of TestPhase3_Scheduling.test_view_schedule __________
tests/test_e2e_complete.py:247: in setup_method
    self.tester = RefiloeE2ETester()
tests/test_e2e_complete.py:32: in __init__
    self.process_message = RefiloeService().handle_message
E   TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
__________ ERROR at setup of TestPhase3_Scheduling.test_book_sessions __________
tests/test_e2e_complete.py:247: in setup_method
    self.tester = RefiloeE2ETester()
tests/test_e2e_complete.py:32: in __init__
    self.process_message = RefiloeService().handle_message
E   TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
________ ERROR at setup of TestPhase3_Scheduling.test_cancel_reschedule ________
tests/test_e2e_complete.py:247: in setup_method
    self.tester = RefiloeE2ETester()
tests/test_e2e_complete.py:32: in __init__
    self.process_message = RefiloeService().handle_message
E   TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
=================================== FAILURES ===================================
_________________ TestRealIntegration.test_booking_system_real _________________
tests/test_integration_real.py:182: in test_booking_system_real
    }).execute()
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/postgrest/_sync/request_builder.py:70: in execute
    raise APIError(r.json())
E   postgrest.exceptions.APIError: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'booking_date' column of 'bookings' in the schema cache"}
___ TestTrainerRegistrationReal.test_trainer_recognition_after_registration ____
tests/test_phase1_registration.py:252: in test_trainer_recognition_after_registration
    assert response.get('success') == True
E   assert False == True
E    +  where False = <built-in method get of dict object at 0x7fdf3f66f500>('success')
E    +    where <built-in method get of dict object at 0x7fdf3f66f500> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
__ TestClientRegistrationReal.test_client_receives_welcome_after_registration __
tests/test_phase1_registration.py:297: in test_client_receives_welcome_after_registration
    assert response.get('success') == True
E   assert False == True
E    +  where False = <built-in method get of dict object at 0x7fdf2eefb280>('success')
E    +    where <built-in method get of dict object at 0x7fdf2eefb280> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_____________ TestAddClientReal.test_add_client_command_variations _____________
tests/test_phase2_client_management.py:71: in test_add_client_command_variations
    assert response.get('success') == True or \
E   AssertionError: Failed to add client with command: Add client Sarah 0821234567
E   assert (False == True or 'added' in '' or 'registered' in '')
E    +  where False = <built-in method get of dict object at 0x7fdf2ef33d00>('success')
E    +    where <built-in method get of dict object at 0x7fdf2ef33d00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
E    +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
E    +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
E    +      where '' = <built-in method get of dict object at 0x7fdf2ef33d00>('message', '')
E    +        where <built-in method get of dict object at 0x7fdf2ef33d00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
E    +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
E    +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
E    +      where '' = <built-in method get of dict object at 0x7fdf2ef33d00>('message', '')
E    +        where <built-in method get of dict object at 0x7fdf2ef33d00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
------------------------------ Captured log setup ------------------------------
INFO     refiloe:logger.py:21 AI Intent Handler initialized with Claude
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
________________ TestViewClientsReal.test_view_clients_commands ________________
tests/test_phase2_client_management.py:160: in test_view_clients_commands
    assert 'sarah' in message or 'john' in message or 'mike' in message or \
E   AssertionError: Failed to list clients with command: Show my clients
E   assert ('sarah' in '' or 'john' in '' or 'mike' in '' or 'client' in '')
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
___________ TestCustomPricingReal.test_set_custom_pricing_variations ___________
tests/test_phase2_client_management.py:216: in test_set_custom_pricing_variations
    assert response.get('success') == True or \
E   AssertionError: Failed to set pricing with: Set Sarah's rate to R450
E   assert (False == True or 'updated' in '' or 'set' in '')
E    +  where False = <built-in method get of dict object at 0x7fdf2cde8a40>('success')
E    +    where <built-in method get of dict object at 0x7fdf2cde8a40> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
E    +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
E    +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
E    +      where '' = <built-in method get of dict object at 0x7fdf2cde8a40>('message', '')
E    +        where <built-in method get of dict object at 0x7fdf2cde8a40> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
E    +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
E    +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
E    +      where '' = <built-in method get of dict object at 0x7fdf2cde8a40>('message', '')
E    +        where <built-in method get of dict object at 0x7fdf2cde8a40> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_______________ TestCustomPricingReal.test_check_client_pricing ________________
tests/test_phase2_client_management.py:239: in test_check_client_pricing
    assert 'r' in message or 'rand' in message or \
E   AssertionError: Failed to show pricing with: What is Sarah's rate?
E   assert ('r' in '' or 'rand' in '' or False)
E    +  where False = any(<generator object TestCustomPricingReal.test_check_client_pricing.<locals>.<genexpr> at 0x7fdf2ef5b140>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
______ TestClientManagementEdgeCases.test_add_client_with_duplicate_phone ______
tests/test_phase2_client_management.py:268: in test_add_client_with_duplicate_phone
    assert 'already' in response.get('message', '').lower() or \
E   assert ('already' in '' or 'exists' in '')
E    +  where '' = <built-in method lower of str object at 0x7fdf4353fba0>()
E    +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
E    +      where '' = <built-in method get of dict object at 0x7fdf2ce05300>('message', '')
E    +        where <built-in method get of dict object at 0x7fdf2ce05300> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
E    +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
E    +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
E    +      where '' = <built-in method get of dict object at 0x7fdf2ce05300>('message', '')
E    +        where <built-in method get of dict object at 0x7fdf2ce05300> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_____________ TestClientManagementEdgeCases.test_client_not_found ______________
tests/test_phase2_client_management.py:311: in test_client_not_found
    assert 'not found' in response.get('message', '').lower() or \
E   assert ('not found' in '' or "doesn't exist" in '' or 'no client' in '')
E    +  where '' = <built-in method lower of str object at 0x7fdf4353fba0>()
E    +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
E    +      where '' = <built-in method get of dict object at 0x7fdf2cdebc00>('message', '')
E    +        where <built-in method get of dict object at 0x7fdf2cdebc00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
E    +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
E    +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
E    +      where '' = <built-in method get of dict object at 0x7fdf2cdebc00>('message', '')
E    +        where <built-in method get of dict object at 0x7fdf2cdebc00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
E    +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
E    +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
E    +      where '' = <built-in method get of dict object at 0x7fdf2cdebc00>('message', '')
E    +        where <built-in method get of dict object at 0x7fdf2cdebc00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_______________ TestViewScheduleReal.test_view_schedule_commands _______________
tests/test_phase3_scheduling.py:74: in test_view_schedule_commands
    assert 'schedule' in message or 'booking' in message or \
E   AssertionError: Failed to show schedule with: Show my schedule
E   assert ('schedule' in '' or 'booking' in '' or 'session' in '' or 'appointment' in '' or 'no bookings' in '' or 'free' in '')
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
___________ TestCancelRescheduleReal.test_cancel_booking_variations ____________
tests/test_phase3_scheduling.py:245: in test_cancel_booking_variations
    assert 'cancel' in message or 'remove' in message or \
E   AssertionError: Failed to handle cancellation: Cancel Sarah's session tomorrow
E   assert ('cancel' in '' or 'remove' in '' or 'deleted' in '' or False == True)
E    +  where False = <built-in method get of dict object at 0x7fdf2cda2e80>('success')
E    +    where <built-in method get of dict object at 0x7fdf2cda2e80> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_______________ TestCancelRescheduleReal.test_reschedule_booking _______________
tests/test_phase3_scheduling.py:266: in test_reschedule_booking
    assert 'reschedule' in message or 'move' in message or \
E   AssertionError: Failed to handle reschedule: Reschedule John to Tuesday 6pm
E   assert ('reschedule' in '' or 'move' in '' or 'change' in '' or 'updated' in '' or False == True)
E    +  where False = <built-in method get of dict object at 0x7fdf2cd1c8c0>('success')
E    +    where <built-in method get of dict object at 0x7fdf2cd1c8c0> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
____________ TestPhase4_HabitTracking.test_setup_habits_for_clients ____________
tests/test_phases_4_11.py:159: in test_setup_habits_for_clients
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase4_HabitTracking.test_setup_habits_for_clients.<locals>.<genexpr> at 0x7fdf2cd8a5c0>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_____________ TestPhase4_HabitTracking.test_check_habit_compliance _____________
tests/test_phases_4_11.py:180: in test_check_habit_compliance
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase4_HabitTracking.test_check_habit_compliance.<locals>.<genexpr> at 0x7fdf2cd8b2e0>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
______________ TestPhase4_HabitTracking.test_send_habit_reminders ______________
tests/test_phases_4_11.py:196: in test_send_habit_reminders
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase4_HabitTracking.test_send_habit_reminders.<locals>.<genexpr> at 0x7fdf2ccd9120>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
______________ TestPhase5_WorkoutsAssessments.test_send_workouts _______________
tests/test_phases_4_11.py:224: in test_send_workouts
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase5_WorkoutsAssessments.test_send_workouts.<locals>.<genexpr> at 0x7fdf2ccd8040>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_____________ TestPhase5_WorkoutsAssessments.test_start_assessment _____________
tests/test_phases_4_11.py:240: in test_start_assessment
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase5_WorkoutsAssessments.test_start_assessment.<locals>.<genexpr> at 0x7fdf2ccd9a80>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_________ TestPhase5_WorkoutsAssessments.test_view_assessment_results __________
tests/test_phases_4_11.py:255: in test_view_assessment_results
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase5_WorkoutsAssessments.test_view_assessment_results.<locals>.<genexpr> at 0x7fdf2ccda2f0>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_______________ TestPhase6_PaymentsRevenue.test_request_payment ________________
tests/test_phases_4_11.py:283: in test_request_payment
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase6_PaymentsRevenue.test_request_payment.<locals>.<genexpr> at 0x7fdf2ccdad40>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_____________ TestPhase6_PaymentsRevenue.test_payment_confirmation _____________
tests/test_phases_4_11.py:315: in test_payment_confirmation
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase6_PaymentsRevenue.test_payment_confirmation.<locals>.<genexpr> at 0x7fdf2ccdbe20>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_______________ TestPhase7_AnalyticsReports.test_view_dashboard ________________
tests/test_phases_4_11.py:343: in test_view_dashboard
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase7_AnalyticsReports.test_view_dashboard.<locals>.<genexpr> at 0x7fdf2ccdb790>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
______________ TestPhase7_AnalyticsReports.test_client_analytics _______________
tests/test_phases_4_11.py:358: in test_client_analytics
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase7_AnalyticsReports.test_client_analytics.<locals>.<genexpr> at 0x7fdf2cb888b0>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
________________ TestPhase8_ClientFeatures.test_client_booking _________________
tests/test_phases_4_11.py:388: in test_client_booking
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase8_ClientFeatures.test_client_booking.<locals>.<genexpr> at 0x7fdf2ccd9f30>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_____________ TestPhase8_ClientFeatures.test_client_habit_logging ______________
tests/test_phases_4_11.py:405: in test_client_habit_logging
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase8_ClientFeatures.test_client_habit_logging.<locals>.<genexpr> at 0x7fdf2ccd84f0>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
________________ TestPhase8_ClientFeatures.test_client_progress ________________
tests/test_phases_4_11.py:421: in test_client_progress
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase8_ClientFeatures.test_client_progress.<locals>.<genexpr> at 0x7fdf2cd8bf10>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
__________________ TestPhase9_Challenges.test_view_challenges __________________
tests/test_phases_4_11.py:449: in test_view_challenges
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase9_Challenges.test_view_challenges.<locals>.<genexpr> at 0x7fdf2cd8b5b0>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_______________ TestPhase9_Challenges.test_join_leave_challenges _______________
tests/test_phases_4_11.py:465: in test_join_leave_challenges
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase9_Challenges.test_join_leave_challenges.<locals>.<genexpr> at 0x7fdf2cb88d60>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
____________________ TestPhase9_Challenges.test_leaderboard ____________________
tests/test_phases_4_11.py:481: in test_leaderboard
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase9_Challenges.test_leaderboard.<locals>.<genexpr> at 0x7fdf2cb894e0>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
______________ TestPhase10_AdvancedFeatures.test_bulk_operations _______________
tests/test_phases_4_11.py:508: in test_bulk_operations
    assert any(word in str(response).lower() for word in
E   assert False
E    +  where False = any(<generator object TestPhase10_AdvancedFeatures.test_bulk_operations.<locals>.<genexpr> at 0x7fdf2cb89d50>)
------------------------------ Captured log call -------------------------------
INFO     refiloe:logger.py:21 Background scheduler started
INFO     refiloe:logger.py:21 Routes setup complete
ERROR    refiloe:logger.py:25 Error handling message: WhatsAppService.__init__() missing 2 required positional arguments: 'supabase_client' and 'logger'
_____________ TestPhase3_SchedulingBookings.test_cancel_reschedule _____________
tests/test_refiloe_complete.py:329: in test_cancel_reschedule
    assert "reschedul" in response['message'].lower() or "moved" in response['message'].lower()
E   assert ('reschedul' in "today's schedule:\n9:00 am - sarah johnson\n2:00 pm - john doe" or 'moved' in "today's schedule:\n9:00 am - sarah johnson\n2:00 pm - john doe")
E    +  where "today's schedule:\n9:00 am - sarah johnson\n2:00 pm - john doe" = <built-in method lower of str object at 0x7fdf3fbee170>()
E    +    where <built-in method lower of str object at 0x7fdf3fbee170> = "Today's schedule:\n9:00 AM - Sarah Johnson\n2:00 PM - John Doe".lower
E    +  and   "today's schedule:\n9:00 am - sarah johnson\n2:00 pm - john doe" = <built-in method lower of str object at 0x7fdf3fbee170>()
E    +    where <built-in method lower of str object at 0x7fdf3fbee170> = "Today's schedule:\n9:00 AM - Sarah Johnson\n2:00 PM - John Doe".lower
_______________ TestPhase6_PaymentsRevenue.test_request_payment ________________
tests/test_refiloe_complete.py:368: in test_request_payment
    assert "payment" in response['message'].lower() or "invoice" in response['message'].lower()
E   assert ('payment' in "welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?" or 'invoice' in "welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?")
E    +  where "welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?" = <built-in method lower of str object at 0x7fdf3fbe2fb0>()
E    +    where <built-in method lower of str object at 0x7fdf3fbe2fb0> = "Welcome to Refiloe! I'm here to help you manage your personal training business. Are you a trainer or a client?".lower
E    +  and   "welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?" = <built-in method lower of str object at 0x7fdf3fbe2fb0>()
E    +    where <built-in method lower of str object at 0x7fdf3fbe2fb0> = "Welcome to Refiloe! I'm here to help you manage your personal training business. Are you a trainer or a client?".lower
_______________ TestPhase10_AdvancedFeatures.test_error_handling _______________
tests/test_refiloe_complete.py:424: in test_error_handling
    assert any(word in response['message'].lower() for word in ["past", "future", "cannot"])
E   assert False
E    +  where False = any(<generator object TestPhase10_AdvancedFeatures.test_error_handling.<locals>.<genexpr> at 0x7fdf2cd44200>)
=============================== warnings summary ===============================
../../../../../opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py:679: 19 warnings
  /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/gotrue/types.py:679: PydanticDeprecatedSince20: The `update_forward_refs` method is deprecated; use `model_rebuild` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    model.update_forward_refs()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
--------------------------------- JSON report ----------------------------------
report saved to: test-results.json
- Generated html report: file:///home/runner/work/whatsapp-ai-assistant/whatsapp-ai-assistant/test-report.html -
=========================== short test summary info ============================
FAILED tests/test_integration_real.py::TestRealIntegration::test_booking_system_real - postgrest.exceptions.APIError: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'booking_date' column of 'bookings' in the schema cache"}
FAILED tests/test_phase1_registration.py::TestTrainerRegistrationReal::test_trainer_recognition_after_registration - assert False == True
 +  where False = <built-in method get of dict object at 0x7fdf3f66f500>('success')
 +    where <built-in method get of dict object at 0x7fdf3f66f500> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
FAILED tests/test_phase1_registration.py::TestClientRegistrationReal::test_client_receives_welcome_after_registration - assert False == True
 +  where False = <built-in method get of dict object at 0x7fdf2eefb280>('success')
 +    where <built-in method get of dict object at 0x7fdf2eefb280> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
FAILED tests/test_phase2_client_management.py::TestAddClientReal::test_add_client_command_variations - AssertionError: Failed to add client with command: Add client Sarah 0821234567
assert (False == True or 'added' in '' or 'registered' in '')
 +  where False = <built-in method get of dict object at 0x7fdf2ef33d00>('success')
 +    where <built-in method get of dict object at 0x7fdf2ef33d00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
 +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
 +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
 +      where '' = <built-in method get of dict object at 0x7fdf2ef33d00>('message', '')
 +        where <built-in method get of dict object at 0x7fdf2ef33d00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
 +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
 +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
 +      where '' = <built-in method get of dict object at 0x7fdf2ef33d00>('message', '')
 +        where <built-in method get of dict object at 0x7fdf2ef33d00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
FAILED tests/test_phase2_client_management.py::TestViewClientsReal::test_view_clients_commands - AssertionError: Failed to list clients with command: Show my clients
assert ('sarah' in '' or 'john' in '' or 'mike' in '' or 'client' in '')
FAILED tests/test_phase2_client_management.py::TestCustomPricingReal::test_set_custom_pricing_variations - AssertionError: Failed to set pricing with: Set Sarah's rate to R450
assert (False == True or 'updated' in '' or 'set' in '')
 +  where False = <built-in method get of dict object at 0x7fdf2cde8a40>('success')
 +    where <built-in method get of dict object at 0x7fdf2cde8a40> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
 +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
 +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
 +      where '' = <built-in method get of dict object at 0x7fdf2cde8a40>('message', '')
 +        where <built-in method get of dict object at 0x7fdf2cde8a40> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
 +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
 +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
 +      where '' = <built-in method get of dict object at 0x7fdf2cde8a40>('message', '')
 +        where <built-in method get of dict object at 0x7fdf2cde8a40> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
FAILED tests/test_phase2_client_management.py::TestCustomPricingReal::test_check_client_pricing - AssertionError: Failed to show pricing with: What is Sarah's rate?
assert ('r' in '' or 'rand' in '' or False)
 +  where False = any(<generator object TestCustomPricingReal.test_check_client_pricing.<locals>.<genexpr> at 0x7fdf2ef5b140>)
FAILED tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_add_client_with_duplicate_phone - assert ('already' in '' or 'exists' in '')
 +  where '' = <built-in method lower of str object at 0x7fdf4353fba0>()
 +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
 +      where '' = <built-in method get of dict object at 0x7fdf2ce05300>('message', '')
 +        where <built-in method get of dict object at 0x7fdf2ce05300> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
 +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
 +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
 +      where '' = <built-in method get of dict object at 0x7fdf2ce05300>('message', '')
 +        where <built-in method get of dict object at 0x7fdf2ce05300> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
FAILED tests/test_phase2_client_management.py::TestClientManagementEdgeCases::test_client_not_found - assert ('not found' in '' or "doesn't exist" in '' or 'no client' in '')
 +  where '' = <built-in method lower of str object at 0x7fdf4353fba0>()
 +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
 +      where '' = <built-in method get of dict object at 0x7fdf2cdebc00>('message', '')
 +        where <built-in method get of dict object at 0x7fdf2cdebc00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
 +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
 +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
 +      where '' = <built-in method get of dict object at 0x7fdf2cdebc00>('message', '')
 +        where <built-in method get of dict object at 0x7fdf2cdebc00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
 +  and   '' = <built-in method lower of str object at 0x7fdf4353fba0>()
 +    where <built-in method lower of str object at 0x7fdf4353fba0> = ''.lower
 +      where '' = <built-in method get of dict object at 0x7fdf2cdebc00>('message', '')
 +        where <built-in method get of dict object at 0x7fdf2cdebc00> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
FAILED tests/test_phase3_scheduling.py::TestViewScheduleReal::test_view_schedule_commands - AssertionError: Failed to show schedule with: Show my schedule
assert ('schedule' in '' or 'booking' in '' or 'session' in '' or 'appointment' in '' or 'no bookings' in '' or 'free' in '')
FAILED tests/test_phase3_scheduling.py::TestCancelRescheduleReal::test_cancel_booking_variations - AssertionError: Failed to handle cancellation: Cancel Sarah's session tomorrow
assert ('cancel' in '' or 'remove' in '' or 'deleted' in '' or False == True)
 +  where False = <built-in method get of dict object at 0x7fdf2cda2e80>('success')
 +    where <built-in method get of dict object at 0x7fdf2cda2e80> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
FAILED tests/test_phase3_scheduling.py::TestCancelRescheduleReal::test_reschedule_booking - AssertionError: Failed to handle reschedule: Reschedule John to Tuesday 6pm
assert ('reschedule' in '' or 'move' in '' or 'change' in '' or 'updated' in '' or False == True)
 +  where False = <built-in method get of dict object at 0x7fdf2cd1c8c0>('success')
 +    where <built-in method get of dict object at 0x7fdf2cd1c8c0> = {'response': "Sorry, I'm having a bit of trouble right now. Please try again in a moment! 😊", 'success': False}.get
FAILED tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_setup_habits_for_clients - assert False
 +  where False = any(<generator object TestPhase4_HabitTracking.test_setup_habits_for_clients.<locals>.<genexpr> at 0x7fdf2cd8a5c0>)
FAILED tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_check_habit_compliance - assert False
 +  where False = any(<generator object TestPhase4_HabitTracking.test_check_habit_compliance.<locals>.<genexpr> at 0x7fdf2cd8b2e0>)
FAILED tests/test_phases_4_11.py::TestPhase4_HabitTracking::test_send_habit_reminders - assert False
 +  where False = any(<generator object TestPhase4_HabitTracking.test_send_habit_reminders.<locals>.<genexpr> at 0x7fdf2ccd9120>)
FAILED tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_send_workouts - assert False
 +  where False = any(<generator object TestPhase5_WorkoutsAssessments.test_send_workouts.<locals>.<genexpr> at 0x7fdf2ccd8040>)
FAILED tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_start_assessment - assert False
 +  where False = any(<generator object TestPhase5_WorkoutsAssessments.test_start_assessment.<locals>.<genexpr> at 0x7fdf2ccd9a80>)
FAILED tests/test_phases_4_11.py::TestPhase5_WorkoutsAssessments::test_view_assessment_results - assert False
 +  where False = any(<generator object TestPhase5_WorkoutsAssessments.test_view_assessment_results.<locals>.<genexpr> at 0x7fdf2ccda2f0>)
FAILED tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue::test_request_payment - assert False
 +  where False = any(<generator object TestPhase6_PaymentsRevenue.test_request_payment.<locals>.<genexpr> at 0x7fdf2ccdad40>)
FAILED tests/test_phases_4_11.py::TestPhase6_PaymentsRevenue::test_payment_confirmation - assert False
 +  where False = any(<generator object TestPhase6_PaymentsRevenue.test_payment_confirmation.<locals>.<genexpr> at 0x7fdf2ccdbe20>)
FAILED tests/test_phases_4_11.py::TestPhase7_AnalyticsReports::test_view_dashboard - assert False
 +  where False = any(<generator object TestPhase7_AnalyticsReports.test_view_dashboard.<locals>.<genexpr> at 0x7fdf2ccdb790>)
FAILED tests/test_phases_4_11.py::TestPhase7_AnalyticsReports::test_client_analytics - assert False
 +  where False = any(<generator object TestPhase7_AnalyticsReports.test_client_analytics.<locals>.<genexpr> at 0x7fdf2cb888b0>)
FAILED tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_booking - assert False
 +  where False = any(<generator object TestPhase8_ClientFeatures.test_client_booking.<locals>.<genexpr> at 0x7fdf2ccd9f30>)
FAILED tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_habit_logging - assert False
 +  where False = any(<generator object TestPhase8_ClientFeatures.test_client_habit_logging.<locals>.<genexpr> at 0x7fdf2ccd84f0>)
FAILED tests/test_phases_4_11.py::TestPhase8_ClientFeatures::test_client_progress - assert False
 +  where False = any(<generator object TestPhase8_ClientFeatures.test_client_progress.<locals>.<genexpr> at 0x7fdf2cd8bf10>)
FAILED tests/test_phases_4_11.py::TestPhase9_Challenges::test_view_challenges - assert False
 +  where False = any(<generator object TestPhase9_Challenges.test_view_challenges.<locals>.<genexpr> at 0x7fdf2cd8b5b0>)
FAILED tests/test_phases_4_11.py::TestPhase9_Challenges::test_join_leave_challenges - assert False
 +  where False = any(<generator object TestPhase9_Challenges.test_join_leave_challenges.<locals>.<genexpr> at 0x7fdf2cb88d60>)
FAILED tests/test_phases_4_11.py::TestPhase9_Challenges::test_leaderboard - assert False
 +  where False = any(<generator object TestPhase9_Challenges.test_leaderboard.<locals>.<genexpr> at 0x7fdf2cb894e0>)
FAILED tests/test_phases_4_11.py::TestPhase10_AdvancedFeatures::test_bulk_operations - assert False
 +  where False = any(<generator object TestPhase10_AdvancedFeatures.test_bulk_operations.<locals>.<genexpr> at 0x7fdf2cb89d50>)
FAILED tests/test_refiloe_complete.py::TestPhase3_SchedulingBookings::test_cancel_reschedule - assert ('reschedul' in "today's schedule:\n9:00 am - sarah johnson\n2:00 pm - john doe" or 'moved' in "today's schedule:\n9:00 am - sarah johnson\n2:00 pm - john doe")
 +  where "today's schedule:\n9:00 am - sarah johnson\n2:00 pm - john doe" = <built-in method lower of str object at 0x7fdf3fbee170>()
 +    where <built-in method lower of str object at 0x7fdf3fbee170> = "Today's schedule:\n9:00 AM - Sarah Johnson\n2:00 PM - John Doe".lower
 +  and   "today's schedule:\n9:00 am - sarah johnson\n2:00 pm - john doe" = <built-in method lower of str object at 0x7fdf3fbee170>()
 +    where <built-in method lower of str object at 0x7fdf3fbee170> = "Today's schedule:\n9:00 AM - Sarah Johnson\n2:00 PM - John Doe".lower
FAILED tests/test_refiloe_complete.py::TestPhase6_PaymentsRevenue::test_request_payment - assert ('payment' in "welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?" or 'invoice' in "welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?")
 +  where "welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?" = <built-in method lower of str object at 0x7fdf3fbe2fb0>()
 +    where <built-in method lower of str object at 0x7fdf3fbe2fb0> = "Welcome to Refiloe! I'm here to help you manage your personal training business. Are you a trainer or a client?".lower
 +  and   "welcome to refiloe! i'm here to help you manage your personal training business. are you a trainer or a client?" = <built-in method lower of str object at 0x7fdf3fbe2fb0>()
 +    where <built-in method lower of str object at 0x7fdf3fbe2fb0> = "Welcome to Refiloe! I'm here to help you manage your personal training business. Are you a trainer or a client?".lower
FAILED tests/test_refiloe_complete.py::TestPhase10_AdvancedFeatures::test_error_handling - assert False
 +  where False = any(<generator object TestPhase10_AdvancedFeatures.test_error_handling.<locals>.<genexpr> at 0x7fdf2cd44200>)
ERROR tests/test_e2e_complete.py::TestPhase1_Registration::test_complete_trainer_onboarding - TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
ERROR tests/test_e2e_complete.py::TestPhase1_Registration::test_trainer_recognition_after_registration - TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
ERROR tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_add_client_variations - TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
ERROR tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_view_clients - TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
ERROR tests/test_e2e_complete.py::TestPhase2_ClientManagement::test_custom_pricing - TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
ERROR tests/test_e2e_complete.py::TestPhase3_Scheduling::test_view_schedule - TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
ERROR tests/test_e2e_complete.py::TestPhase3_Scheduling::test_book_sessions - TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
ERROR tests/test_e2e_complete.py::TestPhase3_Scheduling::test_cancel_reschedule - TypeError: RefiloeService.__init__() missing 1 required positional argument: 'supabase_client'
======= 32 failed, 51 passed, 19 warnings, 8 errors in 79.03s (0:01:19) ========
